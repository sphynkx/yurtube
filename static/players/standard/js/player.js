(()=>{function st(n,e,u){return n<e?e:n>u?u:n}function ot(n,e,u){let c=n.getAttribute(e);if(!c)return u;try{return JSON.parse(c)}catch(h){return u}}var lt="/static/img/fallback_video_notfound.gif";function ut(n,e,u){let c=!1,h=null;function r(v){if(!c){c=!0,u&&u("fallback: applying",v);try{e?e.setAttribute("src",lt):n.src=lt,n.load()}catch(P){}}}function w(){h&&(clearTimeout(h),h=null)}n.addEventListener("loadstart",function(){w(),h=setTimeout(function(){!c&&n.readyState<1&&r("watchdog-timeout")},4e3)}),["loadeddata","canplay","canplaythrough","play","playing"].forEach(function(v){n.addEventListener(v,w)}),n.addEventListener("error",function(){c||r("error-event")}),setTimeout(function(){let v=e?e.getAttribute("src")||"":n.currentSrc||n.src||"";!c&&!v&&r("empty-src")},0)}var ft="yrp:";function dt(){try{return localStorage.setItem("__t","1"),localStorage.removeItem("__t"),!0}catch(n){return!1}}function Z(n,e){if(!dt())return e;try{let u=localStorage.getItem(ft+n);return u?JSON.parse(u):e}catch(u){return e}}function tt(n,e){if(dt())try{localStorage.setItem(ft+n,JSON.stringify(e))}catch(u){}}var z=Object.create(null);function mt(n){let e=String(n).match(/url\(["']?([^"')]+)["']?\)/i);return e&&e[1]?e[1]:null}async function ht(n){if(!n)return!1;if(z[n]!==void 0)return z[n];try{let e=await fetch(n,{method:"GET",credentials:"same-origin",cache:"no-store"});return z[n]=!!e.ok,z[n]}catch(e){return z[n]=!1,!1}}async function V({root:n,button:e,varOn:u,varOff:c,isOn:h,fallbackEmoji:r}){if(e&&e.dataset&&e.dataset.forceEmoji==="1"){e.textContent=r,e.style.webkitMaskImage="",e.style.maskImage="",e.style.backgroundColor="transparent",e.style.color="var(--yrp-icon-color)",e.style.textIndent="0",e.dataset.maskApplied="0";return}let w=h?u:c,P=getComputedStyle(n).getPropertyValue(w)||n.style.getPropertyValue(w)||"",F=mt(P);if(!F){e.textContent=r,e.style.webkitMaskImage="",e.style.maskImage="",e.style.backgroundColor="transparent",e.style.color="var(--yrp-icon-color)",e.style.textIndent="0",e.dataset.maskApplied="0";return}if(await ht(F)){e.textContent="";let U=`var(${w})`;e.style.webkitMaskImage=U,e.style.maskImage=U,e.style.backgroundColor="var(--yrp-icon-color)",e.style.color="",e.style.textIndent="-9999px",e.dataset.maskApplied="1"}else e.textContent=r,e.style.webkitMaskImage="",e.style.maskImage="",e.style.backgroundColor="transparent",e.style.color="var(--yrp-icon-color)",e.style.textIndent="0",e.dataset.maskApplied="0"}async function pt({root:n,video:e,DEBUG:u}){var m;let c=(...t)=>{if(u)try{}catch(i){}},h=new URL(window.location.href),r=h.searchParams.get("p"),w=h.searchParams.get("v")||n.getAttribute("data-video-id")||"";function v(){try{let t=e.textTracks||[];return Array.prototype.filter.call(t,i=>i&&(i.kind==="subtitles"||i.kind==="captions"))}catch(t){return[]}}function P(){return v().length>0}function F(){return v().some(i=>i.mode==="showing")}function j(t){let i=v();i.length&&(t?i.forEach((l,d)=>{l.mode=d===0?"showing":"hidden"}):i.forEach(l=>{l.mode="hidden"}))}r||["yrp-btn-prev","yrp-btn-next"].forEach(t=>{let i=n.querySelector("."+t);i&&(i.style.display="none")});function U(){let t=[],i=document.querySelector("#upnext-block .rb-list"),l=document.querySelector("#panel-upnext .upnext-list"),d=[];return i?d=i.querySelectorAll("a.rb-item[href*='/watch']"):l&&(d=l.querySelectorAll("a.rb-item[href*='/watch']")),d.forEach(_=>{let N=(_.getAttribute("href")||"").match(/[?&]v=([^&]+)/);N&&N[1]&&t.push(decodeURIComponent(N[1]))}),t}let p=r?U():[],k=r?p.indexOf(w):-1;r&&k<0&&(k=0);let q=t=>`pl:${r}:${t}`,A=r?Z(q("order"),"direct")==="shuffle"?"shuffle":"direct":"direct",C=r?(()=>{let t=Z(q("cycle"),"0");return t===!0||t==="1"})():!1;function b(t){if(p.length<=1)return t;let i=0,l=t;for(;i<6&&l===t;)l=Math.floor(Math.random()*p.length),i++;return l===t&&(l=(t+1)%p.length),l}function $(){if(!r)return-1;if(A==="shuffle")return b(k);let t=k+1;return t>=p.length?C?0:-1:t}function K(){if(!r)return-1;if(A==="shuffle")return b(k);let t=k-1;return t<0?C?p.length-1:-1:t}function I(t){if(!r)return;t=Math.max(0,Math.min(p.length-1,t));let i=p[t];if(!i)return;try{let d=Z("resume",{});d&&d[i]&&(delete d[i],tt("resume",d))}catch(d){}let l=new URL(window.location.href);l.searchParams.set("v",i),l.searchParams.set("p",r),window.location.href=l.toString()}let g=document.createElement("div");g.className="yrp-ext-controls",Object.assign(g.style,{position:"absolute",left:"12px",top:"12px",display:"flex",gap:"6px",alignItems:"center",zIndex:"20",background:"transparent",border:"none",padding:"0",opacity:"0",transition:"opacity 150ms ease",pointerEvents:"auto"});function B(t){let i=document.createElement("button");return i.type="button",i.title=t||"",i.setAttribute("aria-label",t||""),Object.assign(i.style,{border:"none",background:"transparent",width:"28px",height:"28px",cursor:"pointer",borderRadius:"14px",backgroundColor:"var(--yrp-icon-color)",color:"var(--yrp-icon-color)",textIndent:"-9999px",outline:"none"}),i.addEventListener("focus",()=>{i.style.outline="2px solid rgba(255,255,255,.6)",i.style.outlineOffset="2px"}),i.addEventListener("blur",()=>{i.style.outline="none"}),i.dataset.forceEmoji="0",i}let a=B("Previous"),o=B("Next"),f=B("Shuffle"),y=B("Cycle playlist"),s=B("Subtitles");try{let t=`/static/players/${((m=n.closest(".player-host"))==null?void 0:m.getAttribute("data-player"))||"standard"}/img/buttons`;[["--icon-prev","prev.svg"],["--icon-next","next.svg"],["--icon-shuffle-on","shuffle-on.svg"],["--icon-shuffle-off","shuffle-off.svg"],["--icon-cycle-on","cycle-on.svg"],["--icon-cycle-off","cycle-off.svg"],["--icon-cc","cc.svg"]].forEach(([i,l])=>{n.style.setProperty(i,`url("${t}/${l}")`)}),n.style.setProperty("--yrp-icon-color","#fff")}catch(t){}g.appendChild(s);let L=n.querySelector(".yrp-btn-prev"),et=n.querySelector(".yrp-btn-next");r&&(L||g.appendChild(a),et||g.appendChild(o),g.appendChild(f),g.appendChild(y));async function Y(){r&&(f.setAttribute("aria-pressed",A==="shuffle"?"true":"false"),await V({root:n,button:f,varOn:"--icon-shuffle-on",varOff:"--icon-shuffle-off",isOn:A==="shuffle",fallbackEmoji:"\u{1F500}"}),f.style.opacity=A==="shuffle"?"1":"0.7")}async function D(){r&&(y.setAttribute("aria-pressed",C?"true":"false"),await V({root:n,button:y,varOn:"--icon-cycle-on",varOff:"--icon-cycle-off",isOn:!!C,fallbackEmoji:"\u{1F501}"}),y.style.opacity=C?"1":"0.7")}async function nt(){r&&(await V({root:n,button:a,varOn:"--icon-prev",varOff:"--icon-prev",isOn:!0,fallbackEmoji:"\u23EE"}),await V({root:n,button:o,varOn:"--icon-next",varOff:"--icon-next",isOn:!0,fallbackEmoji:"\u23ED"}))}async function H(){let t=P();s.disabled=!t,s.style.opacity=t?"1":"0.4",await V({root:n,button:s,varOn:"--icon-cc",varOff:"--icon-cc",isOn:!0,fallbackEmoji:"CC"}),t||(s.textContent="CC",s.style.textIndent="0",s.style.backgroundColor="transparent")}a.addEventListener("click",function(){let t=K();t>=0&&I(t)}),o.addEventListener("click",function(){let t=$();t>=0&&I(t)}),f.addEventListener("click",function(){A=A==="shuffle"?"direct":"shuffle",r&&tt(q("order"),A),Y(),J()}),y.addEventListener("click",function(){C=!C,r&&tt(q("cycle"),C?"1":"0"),D(),J()}),s.addEventListener("click",function(){if(!P())return;let t=!F();j(t),J()});try{let t=n.querySelector(".yrp-video-wrap")||n;getComputedStyle(t).position==="static"&&(t.style.position="relative"),t.appendChild(g)}catch(t){n.appendChild(g)}await nt(),await Y(),await D(),await H();let S=null;function Q(){g.style.opacity="1",S&&clearTimeout(S),S=setTimeout(()=>{g.style.opacity="0"},1600)}function J(){g.style.opacity="1",S&&clearTimeout(S),S=setTimeout(()=>{g.style.opacity="0"},1800)}["mouseenter","mousemove","pointermove","touchstart"].forEach(t=>{(n||document).addEventListener(t,()=>Q(),{passive:!0})}),e.addEventListener("mouseleave",function(){S&&(clearTimeout(S),S=null),g.style.opacity="0"}),r&&(e.addEventListener("ended",function(){let t=$();t>=0&&I(t)}),document.addEventListener("keydown",function(t){let i=t.target&&t.target.tagName?t.target.tagName.toUpperCase():"";if(t.ctrlKey||t.metaKey||t.altKey||i==="INPUT"||i==="TEXTAREA"||t.target.isContentEditable)return;let l=t.code||"";if(l==="PageUp"){t.preventDefault();let d=K();d>=0&&I(d)}else if(l==="PageDown"){t.preventDefault();let d=$();d>=0&&I(d)}}))}var vt={};function gt(){try{let e=new URL(vt.url).pathname.match(/\/static\/players\/([^\/]+)\//);if(e&&e[1])return e[1]}catch(n){}try{let e=(document.currentScript&&document.currentScript.src||"").match(/\/static\/players\/([^\/]+)\//);if(e&&e[1])return e[1]}catch(n){}try{let n=document.querySelector(".player-host[data-player]");if(n){let e=String(n.getAttribute("data-player")||"").trim();if(e)return e}}catch(n){}return"standard"}function yt(n,e){let u=null;try{u=n.play()}catch(c){e&&e("play threw",c),u=null}u&&typeof u.then=="function"?u.then(function(){e&&e("play resolved")}).catch(function(c){if(e&&e("play rejected",{name:c&&c.name,msg:c&&c.message}),!n.muted){n.muted=!0,n.setAttribute("muted","");try{n.play()}catch(h){}}}):setTimeout(function(){if(n.paused){n.muted=!0,n.setAttribute("muted","");try{n.play()}catch(c){}}},0)}function ct(){let n=gt(),e="/static/players/"+n,u=document.querySelectorAll('.player-host[data-player="'+n+'"]');u.length!==0&&fetch(e+"/templates/player.html",{credentials:"same-origin"}).then(c=>c.text()).then(function(c){for(let h=0;h<u.length;h++)bt(u[h],c,e)}).catch(function(){})}function bt(n,e,u){n.innerHTML=e;let c=n.querySelector(".yrp-container"),h=c.querySelector(".yrp-video-wrap"),r=c.querySelector(".yrp-video"),w=r.querySelector("source"),v=c.querySelector(".yrp-center-play"),P=c.querySelector(".yrp-center-logo"),F=n.getAttribute("data-video-src")||"",j=n.getAttribute("data-poster-url")||"",U=ot(n,"data-subtitles",[]),p=ot(n,"data-options",{}),k=n.getAttribute("data-sprites-vtt")||"",q=n.getAttribute("data-caption-vtt")||"",A=n.getAttribute("data-caption-lang")||"",C=/\byrpdebug=1\b/i.test(location.search)||!!(p&&p.debug);function b(){if(C)try{}catch(a){}}if(P&&P.setAttribute("src",u+"/img/logo.png"),w&&w.setAttribute("src",F),j&&r.setAttribute("poster",j),p&&p.muted&&r.setAttribute("muted",""),p&&p.loop&&r.setAttribute("loop",""),r.setAttribute("playsinline",""),r.setAttribute("controls",""),Array.isArray(U)&&U.forEach(function(a){if(!a||!a.src)return;let o=document.createElement("track");o.setAttribute("kind","subtitles"),a.srclang&&o.setAttribute("srclang",String(a.srclang)),a.label&&o.setAttribute("label",String(a.label)),o.setAttribute("src",String(a.src)),a.default&&o.setAttribute("default",""),r.appendChild(o)}),q)try{let a=document.createElement("track");a.setAttribute("kind","subtitles"),a.setAttribute("src",q),a.setAttribute("srclang",A||"auto"),a.setAttribute("label",A||"Original"),a.setAttribute("default",""),r.appendChild(a)}catch(a){b("caption track append failed",a)}function $(){try{let a=r.textTracks;if(!a||a.length===0)return;let o=!!(p&&p.subtitles===!0),f=!1;for(let y=0;y<a.length;y++){let s=a[y];if(s.kind==="subtitles"||s.kind==="captions"){let L=o||s.language===(A||s.srclang);!f&&L?(s.mode="showing",f=!0):s.mode="hidden"}}if(!f)for(let y=0;y<a.length;y++){let s=a[y];if(s.kind==="subtitles"||s.kind==="captions"){s.mode="showing";break}}}catch(a){}}try{r.load(),b("video.load() called",{src:F})}catch(a){b("video.load() error",a)}ut(r,w,b);function K(){r.paused?c.classList.remove("playing"):c.classList.add("playing")}["loadedmetadata","loadeddata","canplay","canplaythrough","play","playing","pause","stalled","suspend","waiting","error","abort","emptied"].forEach(function(a){r.addEventListener(a,function(){b("event",a,{rs:r.readyState,paused:r.paused,muted:r.muted})})}),r.addEventListener("play",K),r.addEventListener("pause",K),r.addEventListener("loadedmetadata",function(){$();try{let a=r.textTracks;for(let o=0;o<a.length;o++){let f=a[o];f.addEventListener&&f.addEventListener("load",$)}}catch(a){}});let I=!1;function g(){I||(I=!0,setTimeout(function(){I=!1},180),r.paused?yt(r,b):r.pause())}v&&v.addEventListener("click",function(){g()});function B(a){let o=a.target,f=o&&o.tagName?o.tagName.toUpperCase():"";if(o&&(o.isContentEditable||f==="INPUT"||f==="TEXTAREA")||a.ctrlKey||a.metaKey||a.altKey)return;let y=(a.key||"").toLowerCase(),s=a.code||"";if(y==="j"||s==="ArrowLeft")a.preventDefault(),r.currentTime=Math.max(0,(r.currentTime||0)-5);else if(y==="l"||s==="ArrowRight"){a.preventDefault();let L=isFinite(r.duration)?r.duration:1e9;r.currentTime=Math.min((r.currentTime||0)+5,L)}else y==="m"?(a.preventDefault(),r.muted=!r.muted):y==="f"&&(a.preventDefault(),document.fullscreenElement?document.exitFullscreen().catch(function(){}):c.requestFullscreen&&c.requestFullscreen().catch(function(){}))}document.addEventListener("keydown",B),function(){let a=!!(p&&p.autoplay===!0);if(b("autoplay check",{WANT:a,opt:p}),!a)return;function o(y){b("autoplay attempt",y),yt(r,b)}r.readyState>=1&&o("readyState>=1");let f=function(){r.removeEventListener("canplay",f),o("canplay")};r.addEventListener("canplay",f),setTimeout(function(){r.paused&&o("watchdog")},1200)}(),function(){let a=0;if(p&&typeof p.start=="number"&&p.start>0&&(a=Math.max(0,p.start)),!a)return;let o=function(){try{r.currentTime=Math.min(a,Math.floor(r.duration||a))}catch(f){}};isFinite(r.duration)&&r.duration>0?o():r.addEventListener("loadedmetadata",function f(){r.removeEventListener("loadedmetadata",f),o()})}(),function(){let o=[],f=!1,y=!1,s=null,L=0,et=160,Y=90;function D(m){let t=String(m||"").match(/^(\d{2}):(\d{2}):(\d{2}\.\d{3})$/);if(!t)return 0;let i=parseInt(t[1],10),l=parseInt(t[2],10),d=parseFloat(t[3]);return i*3600+l*60+d}function nt(m,t){if(!t)return"";if(/^https?:\/\//i.test(t)||t.startsWith("/"))return t;try{return new URL(m,window.location.origin).pathname.replace(/\/sprites\.vtt$/,"")+"/"+t.replace(/^\/+/,"")}catch(i){return t}}function H(){return document.fullscreenElement||h||c}function S(){if(s)return s;s=document.createElement("div"),s.className="std-sprite-pop",s.style.pointerEvents="none",s.style.display="none",s.style.border="1px solid #333",s.style.background="#000",s.style.overflow="hidden",s.style.boxShadow="0 4px 12px rgba(0,0,0,.4)",s.style.borderRadius="4px",s.style.zIndex="9999";let m=H();if(document.fullscreenElement)s.style.position="fixed",m.appendChild(s);else{s.style.position="absolute";let t=m;getComputedStyle(t).position==="static"&&(t.style.position="relative"),t.appendChild(s)}return s}document.addEventListener("fullscreenchange",function(){if(!s)return;let m=H();try{m.appendChild(s),s.style.position=document.fullscreenElement?"fixed":"absolute"}catch(t){}});function Q(){!k||f||y||fetch(k,{credentials:"same-origin"}).then(m=>m.text()).then(function(m){let t=m.split(/\r?\n/);for(let i=0;i<t.length;i++){let l=t[i].trim();if(l&&l.indexOf("-->")>=0){let d=l.split("-->").map(O=>O.trim());if(d.length<2)continue;let _=D(d[0]),M=D(d[1]),N=(t[i+1]||"").trim(),X="",x=0,E=0,R=0,G=0,T=N.indexOf("#xywh=");if(T>0){X=N.substring(0,T);let O=N.substring(T+6).split(",");O.length===4&&(x=parseInt(O[0],10),E=parseInt(O[1],10),R=parseInt(O[2],10),G=parseInt(O[3],10))}let W=nt(k,X);o.push({start:_,end:M,spriteUrl:W,x,y:E,w:R,h:G}),M>L&&(L=M),i++}}f=!0,b("sprites VTT loaded (standard)",{cues:o.length,durationApprox:L})}).catch(function(m){y=!0,b("sprites VTT load failed (standard)",m)})}function J(m){if(!k||!o.length)return;let t=r.getBoundingClientRect(),i=H().getBoundingClientRect(),l=Math.max(36,Math.min(140,Math.round(t.height*.12))),d=m.clientX,_=Math.max(t.left,Math.min(d,t.right)),M=t.width>0?(_-t.left)/t.width:0;M=Math.max(0,Math.min(1,M));let X=(isFinite(r.duration)&&r.duration>0?r.duration:L)*M,x=null;for(let at=0;at<o.length;at++){let it=o[at];if(X>=it.start&&X<it.end){x=it;break}}let E=S();if(!x||!x.spriteUrl){E.style.display="none";return}let R=x.w>0?x.w:et,G=x.h>0?x.h:Y;for(;E.firstChild;)E.removeChild(E.firstChild);let T=document.createElement("img");T.src=x.spriteUrl,T.style.position="absolute",T.style.left=-x.x+"px",T.style.top=-x.y+"px",T.style.pointerEvents="none",E.appendChild(T),E.style.display="block",E.style.width=R+"px",E.style.height=G+"px";let W=!!document.fullscreenElement,O=W?st(_-R/2,i.left,i.right-R):st(_-i.left-R/2,t.left-i.left,t.right-i.left-R),rt=t.bottom-(W?0:i.top)-G-l;W||(rt=Math.max(0,rt)),E.style.left=O+"px",E.style.top=rt+"px"}k&&(r.addEventListener("loadedmetadata",function(){Q()}),setTimeout(function(){!f&&!y&&Q()},2500),r.addEventListener("mousemove",function(m){f&&J(m)}),r.addEventListener("mouseleave",function(){s&&(s.style.display="none")}))}(),pt({root:c,video:r,DEBUG:C}),K()}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",ct):ct();})();
