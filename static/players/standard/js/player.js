(()=>{function dt(e,t,d){return e<t?t:e>d?d:e}function pt(e,t,d){let u=e.getAttribute(t);if(!u)return d;try{return JSON.parse(u)}catch(g){return d}}var ht="/static/img/fallback_video_notfound.gif";function gt(e,t,d){let u=!1,g=null;function n(w){if(!u){u=!0,d&&d("fallback: applying",w);try{t?t.setAttribute("src",ht):e.src=ht,e.load()}catch(N){}}}function k(){g&&(clearTimeout(g),g=null)}e.addEventListener("loadstart",function(){k(),g=setTimeout(function(){!u&&e.readyState<1&&n("watchdog-timeout")},4e3)}),["loadeddata","canplay","canplaythrough","play","playing"].forEach(function(w){e.addEventListener(w,k)}),e.addEventListener("error",function(){u||n("error-event")}),setTimeout(function(){let w=t?t.getAttribute("src")||"":e.currentSrc||e.src||"";!u&&!w&&n("empty-src")},0)}var bt="yrp:";function xt(){try{return localStorage.setItem("__t","1"),localStorage.removeItem("__t"),!0}catch(e){return!1}}function it(e,t){if(!xt())return t;try{let d=localStorage.getItem(bt+e);return d?JSON.parse(d):t}catch(d){return t}}function st(e,t){if(xt())try{localStorage.setItem(bt+e,JSON.stringify(t))}catch(d){}}var tt=Object.create(null);function Et(e){let t=String(e).match(/url\(["']?([^"')]+)["']?\)/i);return t&&t[1]?t[1]:null}async function St(e){if(!e)return!1;if(tt[e]!==void 0)return tt[e];try{let t=await fetch(e,{method:"GET",credentials:"same-origin",cache:"no-store"});return tt[e]=!!t.ok,tt[e]}catch(t){return tt[e]=!1,!1}}async function X({root:e,button:t,varOn:d,varOff:u,isOn:g,fallbackEmoji:n}){if(t&&t.dataset&&t.dataset.forceEmoji==="1"){t.textContent=n,t.style.webkitMaskImage="",t.style.maskImage="",t.style.backgroundColor="transparent",t.style.color="var(--yrp-icon-color)",t.style.textIndent="0",t.dataset.maskApplied="0";return}let k=g?d:u,N=getComputedStyle(e).getPropertyValue(k)||e.style.getPropertyValue(k)||"",q=Et(N);if(!q){t.textContent=n,t.style.webkitMaskImage="",t.style.maskImage="",t.style.backgroundColor="transparent",t.style.color="var(--yrp-icon-color)",t.style.textIndent="0",t.dataset.maskApplied="0";return}if(await St(q)){t.textContent="";let B=`var(${k})`;t.style.webkitMaskImage=B,t.style.maskImage=B,t.style.backgroundColor="var(--yrp-icon-color)",t.style.color="",t.style.textIndent="-9999px",t.dataset.maskApplied="1"}else t.textContent=n,t.style.webkitMaskImage="",t.style.maskImage="",t.style.backgroundColor="transparent",t.style.color="var(--yrp-icon-color)",t.style.textIndent="0",t.dataset.maskApplied="0"}async function vt({root:e,video:t,DEBUG:d}){var nt;let u=(...a)=>{if(d)try{}catch(o){}},g=new URL(window.location.href),n=g.searchParams.get("p"),k=g.searchParams.get("v")||e.getAttribute("data-video-id")||"";function w(){try{let a=t.textTracks||[];return Array.prototype.filter.call(a,o=>o&&(o.kind==="subtitles"||o.kind==="captions"))}catch(a){return[]}}function N(){return w().length>0}function q(){return w().some(o=>o.mode==="showing")}function G(a){let o=w();o.length&&(a?o.forEach((p,h)=>{p.mode=h===0?"showing":"hidden"}):o.forEach(p=>{p.mode="hidden"}))}n||["yrp-btn-prev","yrp-btn-next"].forEach(a=>{let o=e.querySelector("."+a);o&&(o.style.display="none")});function B(){let a=[],o=document.querySelector("#upnext-block .rb-list"),p=document.querySelector("#panel-upnext .upnext-list"),h=[];return o?h=o.querySelectorAll("a.rb-item[href*='/watch']"):p&&(h=p.querySelectorAll("a.rb-item[href*='/watch']")),h.forEach(rt=>{let m=(rt.getAttribute("href")||"").match(/[?&]v=([^&]+)/);m&&m[1]&&a.push(decodeURIComponent(m[1]))}),a}let y=n?B():[],A=n?y.indexOf(k):-1;n&&A<0&&(A=0);let $=a=>`pl:${n}:${a}`,C=n?it($("order"),"direct")==="shuffle"?"shuffle":"direct":"direct",T=n?(()=>{let a=it($("cycle"),"0");return a===!0||a==="1"})():!1;function v(a){if(y.length<=1)return a;let o=0,p=a;for(;o<6&&p===a;)p=Math.floor(Math.random()*y.length),o++;return p===a&&(p=(a+1)%y.length),p}function H(){if(!n)return-1;if(C==="shuffle")return v(A);let a=A+1;return a>=y.length?T?0:-1:a}function R(){if(!n)return-1;if(C==="shuffle")return v(A);let a=A-1;return a<0?T?y.length-1:-1:a}function K(a){if(!n)return;a=Math.max(0,Math.min(y.length-1,a));let o=y[a];if(!o)return;try{let h=it("resume",{});h&&h[o]&&(delete h[o],st("resume",h))}catch(h){}let p=new URL(window.location.href);p.searchParams.set("v",o),p.searchParams.set("p",n),window.location.href=p.toString()}let b=document.createElement("div");b.className="yrp-ext-controls",Object.assign(b.style,{position:"absolute",left:"12px",top:"12px",display:"flex",gap:"6px",alignItems:"center",zIndex:"20",background:"transparent",border:"none",padding:"0",opacity:"0",transition:"opacity 150ms ease",pointerEvents:"auto"});function U(a){let o=document.createElement("button");return o.type="button",o.title=a||"",o.setAttribute("aria-label",a||""),Object.assign(o.style,{border:"none",background:"transparent",width:"28px",height:"28px",cursor:"pointer",borderRadius:"14px",backgroundColor:"var(--yrp-icon-color)",color:"var(--yrp-icon-color)",textIndent:"-9999px",outline:"none"}),o.addEventListener("focus",()=>{o.style.outline="2px solid rgba(255,255,255,.6)",o.style.outlineOffset="2px"}),o.addEventListener("blur",()=>{o.style.outline="none"}),o.dataset.forceEmoji="0",o}let et=U("Previous"),J=U("Next"),V=U("Shuffle"),P=U("Cycle playlist"),L=U("Subtitles");try{let a=`/static/players/${((nt=e.closest(".player-host"))==null?void 0:nt.getAttribute("data-player"))||"standard"}/img/buttons`;[["--icon-prev","prev.svg"],["--icon-next","next.svg"],["--icon-shuffle-on","shuffle-on.svg"],["--icon-shuffle-off","shuffle-off.svg"],["--icon-cycle-on","cycle-on.svg"],["--icon-cycle-off","cycle-off.svg"],["--icon-cc","cc.svg"]].forEach(([o,p])=>{e.style.setProperty(o,`url("${a}/${p}")`)}),e.style.setProperty("--yrp-icon-color","#fff")}catch(a){}b.appendChild(L);let ot=e.querySelector(".yrp-btn-prev"),ct=e.querySelector(".yrp-btn-next");n&&(ot||b.appendChild(et),ct||b.appendChild(J),b.appendChild(V),b.appendChild(P));async function r(){n&&(V.setAttribute("aria-pressed",C==="shuffle"?"true":"false"),await X({root:e,button:V,varOn:"--icon-shuffle-on",varOff:"--icon-shuffle-off",isOn:C==="shuffle",fallbackEmoji:"\u{1F500}"}),V.style.opacity=C==="shuffle"?"1":"0.7")}async function i(){n&&(P.setAttribute("aria-pressed",T?"true":"false"),await X({root:e,button:P,varOn:"--icon-cycle-on",varOff:"--icon-cycle-off",isOn:!!T,fallbackEmoji:"\u{1F501}"}),P.style.opacity=T?"1":"0.7")}async function l(){n&&(await X({root:e,button:et,varOn:"--icon-prev",varOff:"--icon-prev",isOn:!0,fallbackEmoji:"\u23EE"}),await X({root:e,button:J,varOn:"--icon-next",varOff:"--icon-next",isOn:!0,fallbackEmoji:"\u23ED"}))}async function c(){let a=N();L.disabled=!a,L.style.opacity=a?"1":"0.4",await X({root:e,button:L,varOn:"--icon-cc",varOff:"--icon-cc",isOn:!0,fallbackEmoji:"CC"}),a||(L.textContent="CC",L.style.textIndent="0",L.style.backgroundColor="transparent")}et.addEventListener("click",function(){let a=R();a>=0&&K(a)}),J.addEventListener("click",function(){let a=H();a>=0&&K(a)}),V.addEventListener("click",function(){C=C==="shuffle"?"direct":"shuffle",n&&st($("order"),C),r(),W()}),P.addEventListener("click",function(){T=!T,n&&st($("cycle"),T?"1":"0"),i(),W()}),L.addEventListener("click",function(){if(!N())return;let a=!q();G(a),W()});try{let a=e.querySelector(".yrp-video-wrap")||e;getComputedStyle(a).position==="static"&&(a.style.position="relative"),a.appendChild(b)}catch(a){e.appendChild(b)}await l(),await r(),await i(),await c();let s=null;function I(){b.style.opacity="1",s&&clearTimeout(s),s=setTimeout(()=>{b.style.opacity="0"},1600)}function W(){b.style.opacity="1",s&&clearTimeout(s),s=setTimeout(()=>{b.style.opacity="0"},1800)}["mouseenter","mousemove","pointermove","touchstart"].forEach(a=>{(e||document).addEventListener(a,()=>I(),{passive:!0})}),t.addEventListener("mouseleave",function(){s&&(clearTimeout(s),s=null),b.style.opacity="0"}),n&&(t.addEventListener("ended",function(){let a=H();a>=0&&K(a)}),document.addEventListener("keydown",function(a){let o=a.target&&a.target.tagName?a.target.tagName.toUpperCase():"";if(a.ctrlKey||a.metaKey||a.altKey||o==="INPUT"||o==="TEXTAREA"||a.target.isContentEditable)return;let p=a.code||"";if(p==="PageUp"){a.preventDefault();let h=R();h>=0&&K(h)}else if(p==="PageDown"){a.preventDefault();let h=H();h>=0&&K(h)}}))}var Ct={};function kt(){try{let t=new URL(Ct.url).pathname.match(/\/static\/players\/([^\/]+)\//);if(t&&t[1])return t[1]}catch(e){}try{let t=(document.currentScript&&document.currentScript.src||"").match(/\/static\/players\/([^\/]+)\//);if(t&&t[1])return t[1]}catch(e){}try{let e=document.querySelector(".player-host[data-player]");if(e){let t=String(e.getAttribute("data-player")||"").trim();if(t)return t}}catch(e){}return"standard"}function wt(e,t){let d=null;try{d=e.play()}catch(u){t&&t("play threw",u),d=null}d&&typeof d.then=="function"?d.then(function(){t&&t("play resolved")}).catch(function(u){if(t&&t("play rejected",{name:u&&u.name,msg:u&&u.message}),!e.muted){e.muted=!0,e.setAttribute("muted","");try{e.play()}catch(g){}}}):setTimeout(function(){if(e.paused){e.muted=!0,e.setAttribute("muted","");try{e.play()}catch(u){}}},0)}function yt(){let e=kt(),t="/static/players/"+e,d=document.querySelectorAll('.player-host[data-player="'+e+'"]');d.length!==0&&fetch(t+"/templates/player.html",{credentials:"same-origin"}).then(u=>u.text()).then(function(u){for(let g=0;g<d.length;g++)At(d[g],u,t)}).catch(function(){})}function At(e,t,d){e.innerHTML=t;let u=e.querySelector(".yrp-container"),g=u.querySelector(".yrp-video-wrap"),n=u.querySelector(".yrp-video"),k=n.querySelector("source"),w=u.querySelector(".yrp-center-play"),N=u.querySelector(".yrp-center-logo"),q=e.getAttribute("data-video-src")||"",G=e.getAttribute("data-poster-url")||"",B=pt(e,"data-subtitles",[]),y=pt(e,"data-options",{}),A=e.getAttribute("data-sprites-vtt")||"",$=e.getAttribute("data-caption-vtt")||"",C=e.getAttribute("data-caption-lang")||"",T=/\byrpdebug=1\b/i.test(location.search)||!!(y&&y.debug);function v(){if(T)try{}catch(r){}}if(N&&N.setAttribute("src",d+"/img/logo.png"),k&&k.setAttribute("src",q),G&&n.setAttribute("poster",G),y&&y.muted&&n.setAttribute("muted",""),y&&y.loop&&n.setAttribute("loop",""),n.setAttribute("playsinline",""),n.setAttribute("controls",""),Array.isArray(B)&&B.forEach(function(r){if(!r||!r.src)return;let i=document.createElement("track");i.setAttribute("kind","subtitles"),r.srclang&&i.setAttribute("srclang",String(r.srclang)),r.label&&i.setAttribute("label",String(r.label)),i.setAttribute("src",String(r.src)),r.default&&i.setAttribute("default",""),n.appendChild(i)}),$)try{let r=document.createElement("track");r.setAttribute("kind","subtitles"),r.setAttribute("src",$),r.setAttribute("srclang",C||"auto"),r.setAttribute("label",C||"Original"),r.setAttribute("default",""),n.appendChild(r)}catch(r){v("caption track append failed",r)}let H=function(){try{return String(localStorage.getItem("subtitle_lang")||"")}catch(r){return""}}();function R(){try{return n.textTracks?Array.prototype.filter.call(n.textTracks,function(r){return r.kind==="subtitles"||r.kind==="captions"}):[]}catch(r){return[]}}function K(){return R().map(function(i,l){let c=String(i.language||i.srclang||"").toLowerCase(),s=String(i.label||c||"Lang "+(l+1));return{index:l,lang:c,label:s,track:i}})}function b(r){let i=String(r||"").toLowerCase(),l=K();for(let c=0;c<l.length;c++)if(l[c].lang===i||l[c].label.toLowerCase()===i)return l[c].index;return-1}function U(r){let i=R();if(!i.length)return;let l=Math.max(0,Math.min(r,i.length-1));for(let c=0;c<i.length;c++)i[c].mode=c===l?"showing":"disabled"}function et(r){let i=b(r);if(i>=0){U(i);try{localStorage.setItem("subtitle_lang",String(r||""))}catch(l){}}}function J(){try{let r=R();for(let i=0;i<r.length;i++){let l=r[i];if(l.mode==="showing"){let c=String(l.language||l.srclang||"").toLowerCase();if(c)try{localStorage.setItem("subtitle_lang",c)}catch(s){}return}}}catch(r){}}function V(){try{let r=R();if(!r||r.length===0)return;if(H){let c=b(H);if(c>=0){U(c);return}}let i=!!(y&&y.subtitles===!0),l=!1;for(let c=0;c<r.length;c++){let s=r[c],I=i||String(s.language||s.srclang||"")===(C||s.srclang);!l&&I?(s.mode="showing",l=!0):s.mode="disabled"}if(!l)for(let c=0;c<r.length;c++){r[c].mode="showing";break}}catch(r){}}try{n.load(),v("video.load() called",{src:q})}catch(r){v("video.load() error",r)}gt(n,k,v);function P(){n.paused?u.classList.remove("playing"):u.classList.add("playing")}["loadedmetadata","loadeddata","canplay","canplaythrough","play","playing","pause","stalled","suspend","waiting","error","abort","emptied"].forEach(function(r){n.addEventListener(r,function(){v("event",r,{rs:n.readyState,paused:n.paused,muted:n.muted})})}),n.addEventListener("play",P),n.addEventListener("pause",P),n.addEventListener("loadedmetadata",function(){V();try{let r=R();for(let i=0;i<r.length;i++){let l=r[i];l.addEventListener&&l.addEventListener("cuechange",J)}}catch(r){}n.addEventListener("timeupdate",throttle(J,800),{passive:!0})});let L=!1;function ot(){L||(L=!0,setTimeout(function(){L=!1},180),n.paused?wt(n,v):n.pause())}w&&w.addEventListener("click",function(){ot()});function ct(r){let i=r.target,l=i&&i.tagName?i.tagName.toUpperCase():"";if(i&&(i.isContentEditable||l==="INPUT"||l==="TEXTAREA")||r.ctrlKey||r.metaKey||r.altKey)return;let c=(r.key||"").toLowerCase(),s=r.code||"";if(c==="j"||s==="ArrowLeft")r.preventDefault(),n.currentTime=Math.max(0,(n.currentTime||0)-5);else if(c==="l"||s==="ArrowRight"){r.preventDefault();let I=isFinite(n.duration)?n.duration:1e9;n.currentTime=Math.min((n.currentTime||0)+5,I)}else c==="m"?(r.preventDefault(),n.muted=!n.muted):c==="f"&&(r.preventDefault(),document.fullscreenElement?document.exitFullscreen().catch(function(){}):u.requestFullscreen&&u.requestFullscreen().catch(function(){}))}document.addEventListener("keydown",ct),function(){let r=!!(y&&y.autoplay===!0);if(v("autoplay check",{WANT:r,opt:y}),!r)return;function i(c){v("autoplay attempt",c),wt(n,v)}n.readyState>=1&&i("readyState>=1");let l=function(){n.removeEventListener("canplay",l),i("canplay")};n.addEventListener("canplay",l),setTimeout(function(){n.paused&&i("watchdog")},1200)}(),function(){let r=0;if(y&&typeof y.start=="number"&&y.start>0&&(r=Math.max(0,y.start)),!r)return;let i=function(){try{n.currentTime=Math.min(r,Math.floor(n.duration||r))}catch(l){}};isFinite(n.duration)&&n.duration>0?i():n.addEventListener("loadedmetadata",function l(){n.removeEventListener("loadedmetadata",l),i()})}(),function(){let i=[],l=!1,c=!1,s=null,I=0,W=160,nt=90;function a(m){let f=String(m||"").match(/^(\d{2}):(\d{2}):(\d{2}\.\d{3})$/);if(!f)return 0;let x=parseInt(f[1],10),_=parseInt(f[2],10),j=parseFloat(f[3]);return x*3600+_*60+j}function o(m,f){if(!f)return"";if(/^https?:\/\//i.test(f)||f.startsWith("/"))return f;try{return new URL(m,window.location.origin).pathname.replace(/\/sprites\.vtt$/,"")+"/"+f.replace(/^\/+/,"")}catch(x){return f}}function p(){return document.fullscreenElement||g||u}function h(){if(s)return s;s=document.createElement("div"),s.className="std-sprite-pop",s.style.pointerEvents="none",s.style.display="none",s.style.border="1px solid #333",s.style.background="#000",s.style.overflow="hidden",s.style.boxShadow="0 4px 12px rgba(0,0,0,.4)",s.style.borderRadius="4px",s.style.zIndex="9999";let m=p();if(document.fullscreenElement)s.style.position="fixed",m.appendChild(s);else{s.style.position="absolute";let f=m;getComputedStyle(f).position==="static"&&(f.style.position="relative"),f.appendChild(s)}return s}document.addEventListener("fullscreenchange",function(){if(!s)return;let m=p();try{m.appendChild(s),s.style.position=document.fullscreenElement?"fixed":"absolute"}catch(f){}});function rt(){!A||l||c||fetch(A,{credentials:"same-origin"}).then(m=>m.text()).then(function(m){let f=m.split(/\r?\n/);for(let x=0;x<f.length;x++){let _=f[x].trim();if(_&&_.indexOf("-->")>=0){let j=_.split("-->").map(M=>M.trim());if(j.length<2)continue;let z=a(j[0]),D=a(j[1]),at=(f[x+1]||"").trim(),Y="",E=0,S=0,F=0,Q=0,O=at.indexOf("#xywh=");if(O>0){Y=at.substring(0,O);let M=at.substring(O+6).split(",");M.length===4&&(E=parseInt(M[0],10),S=parseInt(M[1],10),F=parseInt(M[2],10),Q=parseInt(M[3],10))}let Z=o(A,Y);i.push({start:z,end:D,spriteUrl:Z,x:E,y:S,w:F,h:Q}),D>I&&(I=D),x++}}l=!0,v("sprites VTT loaded (standard)",{cues:i.length,durationApprox:I})}).catch(function(m){c=!0,v("sprites VTT load failed (standard)",m)})}function mt(m){if(!A||!i.length)return;let f=n.getBoundingClientRect(),x=p().getBoundingClientRect(),_=Math.max(36,Math.min(140,Math.round(f.height*.12))),j=m.clientX,z=Math.max(f.left,Math.min(j,f.right)),D=f.width>0?(z-f.left)/f.width:0;D=Math.max(0,Math.min(1,D));let Y=(isFinite(n.duration)&&n.duration>0?n.duration:I)*D,E=null;for(let ut=0;ut<i.length;ut++){let ft=i[ut];if(Y>=ft.start&&Y<ft.end){E=ft;break}}let S=h();if(!E||!E.spriteUrl){S.style.display="none";return}let F=E.w>0?E.w:W,Q=E.h>0?E.h:nt;for(;S.firstChild;)S.removeChild(S.firstChild);let O=document.createElement("img");O.src=E.spriteUrl,O.style.position="absolute",O.style.left=-E.x+"px",O.style.top=-E.y+"px",O.style.pointerEvents="none",S.appendChild(O),S.style.display="block",S.style.width=F+"px",S.style.height=Q+"px";let Z=!!document.fullscreenElement,M=Z?dt(z-F/2,x.left,x.right-F):dt(z-x.left-F/2,f.left-x.left,f.right-x.left-F),lt=f.bottom-(Z?0:x.top)-Q-_;Z||(lt=Math.max(0,lt)),S.style.left=M+"px",S.style.top=lt+"px"}A&&(n.addEventListener("loadedmetadata",function(){rt()}),setTimeout(function(){!l&&!c&&rt()},2500),n.addEventListener("mousemove",function(m){l&&mt(m)}),n.addEventListener("mouseleave",function(){s&&(s.style.display="none")}))}(),vt({root:u,video:n,DEBUG:T}),P()}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",yt):yt();})();
