(()=>{function yt(n,e,d){return n<e?e:n>d?d:n}function mt(n,e,d){let u=n.getAttribute(e);if(!u)return d;try{return JSON.parse(u)}catch(g){return d}}var bt="/static/img/fallback_video_notfound.gif";function xt(n,e,d){let u=!1,g=null;function r(w){if(!u){u=!0,d&&d("fallback: applying",w);try{e?e.setAttribute("src",bt):n.src=bt,n.load()}catch(M){}}}function A(){g&&(clearTimeout(g),g=null)}n.addEventListener("loadstart",function(){A(),g=setTimeout(function(){!u&&n.readyState<1&&r("watchdog-timeout")},4e3)}),["loadeddata","canplay","canplaythrough","play","playing"].forEach(function(w){n.addEventListener(w,A)}),n.addEventListener("error",function(){u||r("error-event")}),setTimeout(function(){let w=e?e.getAttribute("src")||"":n.currentSrc||n.src||"";!u&&!w&&r("empty-src")},0)}var vt="yrp:";function wt(){try{return localStorage.setItem("__t","1"),localStorage.removeItem("__t"),!0}catch(n){return!1}}function st(n,e){if(!wt())return e;try{let d=localStorage.getItem(vt+n);return d?JSON.parse(d):e}catch(d){return e}}function ot(n,e){if(wt())try{localStorage.setItem(vt+n,JSON.stringify(e))}catch(d){}}var et=Object.create(null);function At(n){let e=String(n).match(/url\(["']?([^"')]+)["']?\)/i);return e&&e[1]?e[1]:null}async function Lt(n){if(!n)return!1;if(et[n]!==void 0)return et[n];try{let e=await fetch(n,{method:"GET",credentials:"same-origin",cache:"no-store"});return et[n]=!!e.ok,et[n]}catch(e){return et[n]=!1,!1}}async function J({root:n,button:e,varOn:d,varOff:u,isOn:g,fallbackEmoji:r}){if(e&&e.dataset&&e.dataset.forceEmoji==="1"){e.textContent=r,e.style.webkitMaskImage="",e.style.maskImage="",e.style.backgroundColor="transparent",e.style.color="var(--yrp-icon-color)",e.style.textIndent="0",e.dataset.maskApplied="0";return}let A=g?d:u,M=getComputedStyle(n).getPropertyValue(A)||n.style.getPropertyValue(A)||"",q=At(M);if(!q){e.textContent=r,e.style.webkitMaskImage="",e.style.maskImage="",e.style.backgroundColor="transparent",e.style.color="var(--yrp-icon-color)",e.style.textIndent="0",e.dataset.maskApplied="0";return}if(await Lt(q)){e.textContent="";let B=`var(${A})`;e.style.webkitMaskImage=B,e.style.maskImage=B,e.style.backgroundColor="var(--yrp-icon-color)",e.style.color="",e.style.textIndent="-9999px",e.dataset.maskApplied="1"}else e.textContent=r,e.style.webkitMaskImage="",e.style.maskImage="",e.style.backgroundColor="transparent",e.style.color="var(--yrp-icon-color)",e.style.textIndent="0",e.dataset.maskApplied="0"}async function St({root:n,video:e,DEBUG:d}){var l;let u=(...t)=>{if(d)try{}catch(c){}},g=new URL(window.location.href),r=g.searchParams.get("p"),A=g.searchParams.get("v")||n.getAttribute("data-video-id")||"";function w(){try{let t=e.textTracks||[];return Array.prototype.filter.call(t,c=>c&&(c.kind==="subtitles"||c.kind==="captions"))}catch(t){return[]}}function M(){return w().length>0}function q(){return w().some(c=>c.mode==="showing")}function X(t){let c=w();c.length&&(t?c.forEach((y,m)=>{y.mode=m===0?"showing":"hidden"}):c.forEach(y=>{y.mode="hidden"}))}r||["yrp-btn-prev","yrp-btn-next"].forEach(t=>{let c=n.querySelector("."+t);c&&(c.style.display="none")});function B(){let t=[],c=document.querySelector("#upnext-block .rb-list"),y=document.querySelector("#panel-upnext .upnext-list"),m=[];return c?m=c.querySelectorAll("a.rb-item[href*='/watch']"):y&&(m=y.querySelectorAll("a.rb-item[href*='/watch']")),m.forEach(ut=>{let z=(ut.getAttribute("href")||"").match(/[?&]v=([^&]+)/);z&&z[1]&&t.push(decodeURIComponent(z[1]))}),t}let p=r?B():[],L=r?p.indexOf(A):-1;r&&L<0&&(L=0);let $=t=>`pl:${r}:${t}`,S=r?st($("order"),"direct")==="shuffle"?"shuffle":"direct":"direct",k=r?(()=>{let t=st($("cycle"),"0");return t===!0||t==="1"})():!1;function v(t){if(p.length<=1)return t;let c=0,y=t;for(;c<6&&y===t;)y=Math.floor(Math.random()*p.length),c++;return y===t&&(y=(t+1)%p.length),y}function N(){if(!r)return-1;if(S==="shuffle")return v(L);let t=L+1;return t>=p.length?k?0:-1:t}function nt(){if(!r)return-1;if(S==="shuffle")return v(L);let t=L-1;return t<0?k?p.length-1:-1:t}function _(t){if(!r)return;t=Math.max(0,Math.min(p.length-1,t));let c=p[t];if(!c)return;try{let m=st("resume",{});m&&m[c]&&(delete m[c],ot("resume",m))}catch(m){}let y=new URL(window.location.href);y.searchParams.set("v",c),y.searchParams.set("p",r),window.location.href=y.toString()}let b=document.createElement("div");b.className="yrp-ext-controls",Object.assign(b.style,{position:"absolute",left:"12px",top:"12px",display:"flex",gap:"6px",alignItems:"center",zIndex:"20",background:"transparent",border:"none",padding:"0",opacity:"0",transition:"opacity 150ms ease",pointerEvents:"auto"});function T(t){let c=document.createElement("button");return c.type="button",c.title=t||"",c.setAttribute("aria-label",t||""),Object.assign(c.style,{border:"none",background:"transparent",width:"28px",height:"28px",cursor:"pointer",borderRadius:"14px",backgroundColor:"var(--yrp-icon-color)",color:"var(--yrp-icon-color)",textIndent:"-9999px",outline:"none"}),c.addEventListener("focus",()=>{c.style.outline="2px solid rgba(255,255,255,.6)",c.style.outlineOffset="2px"}),c.addEventListener("blur",()=>{c.style.outline="none"}),c.dataset.forceEmoji="0",c}let G=T("Previous"),V=T("Next"),R=T("Shuffle"),j=T("Cycle playlist"),I=T("Subtitles");try{let t=`/static/players/${((l=n.closest(".player-host"))==null?void 0:l.getAttribute("data-player"))||"standard"}/img/buttons`;[["--icon-prev","prev.svg"],["--icon-next","next.svg"],["--icon-shuffle-on","shuffle-on.svg"],["--icon-shuffle-off","shuffle-off.svg"],["--icon-cycle-on","cycle-on.svg"],["--icon-cycle-off","cycle-off.svg"],["--icon-cc","cc.svg"]].forEach(([c,y])=>{n.style.setProperty(c,`url("${t}/${y}")`)}),n.style.setProperty("--yrp-icon-color","#fff")}catch(t){}b.appendChild(I);let ct=n.querySelector(".yrp-btn-prev"),W=n.querySelector(".yrp-btn-next");r&&(ct||b.appendChild(G),W||b.appendChild(V),b.appendChild(R),b.appendChild(j));async function H(){r&&(R.setAttribute("aria-pressed",S==="shuffle"?"true":"false"),await J({root:n,button:R,varOn:"--icon-shuffle-on",varOff:"--icon-shuffle-off",isOn:S==="shuffle",fallbackEmoji:"\u{1F500}"}),R.style.opacity=S==="shuffle"?"1":"0.7")}async function rt(){r&&(j.setAttribute("aria-pressed",k?"true":"false"),await J({root:n,button:j,varOn:"--icon-cycle-on",varOff:"--icon-cycle-off",isOn:!!k,fallbackEmoji:"\u{1F501}"}),j.style.opacity=k?"1":"0.7")}async function lt(){r&&(await J({root:n,button:G,varOn:"--icon-prev",varOff:"--icon-prev",isOn:!0,fallbackEmoji:"\u23EE"}),await J({root:n,button:V,varOn:"--icon-next",varOff:"--icon-next",isOn:!0,fallbackEmoji:"\u23ED"}))}async function a(){let t=M();I.disabled=!t,I.style.opacity=t?"1":"0.4",await J({root:n,button:I,varOn:"--icon-cc",varOff:"--icon-cc",isOn:!0,fallbackEmoji:"CC"}),t||(I.textContent="CC",I.style.textIndent="0",I.style.backgroundColor="transparent")}G.addEventListener("click",function(){let t=nt();t>=0&&_(t)}),V.addEventListener("click",function(){let t=N();t>=0&&_(t)}),R.addEventListener("click",function(){S=S==="shuffle"?"direct":"shuffle",r&&ot($("order"),S),H(),o()}),j.addEventListener("click",function(){k=!k,r&&ot($("cycle"),k?"1":"0"),rt(),o()}),I.addEventListener("click",function(){if(!M())return;let t=!q();X(t),o()});try{let t=n.querySelector(".yrp-video-wrap")||n;getComputedStyle(t).position==="static"&&(t.style.position="relative"),t.appendChild(b)}catch(t){n.appendChild(b)}await lt(),await H(),await rt(),await a();let i=null;function s(){b.style.opacity="1",i&&clearTimeout(i),i=setTimeout(()=>{b.style.opacity="0"},1600)}function o(){b.style.opacity="1",i&&clearTimeout(i),i=setTimeout(()=>{b.style.opacity="0"},1800)}["mouseenter","mousemove","pointermove","touchstart"].forEach(t=>{(n||document).addEventListener(t,()=>s(),{passive:!0})}),e.addEventListener("mouseleave",function(){i&&(clearTimeout(i),i=null),b.style.opacity="0"}),r&&(e.addEventListener("ended",function(){let t=N();t>=0&&_(t)}),document.addEventListener("keydown",function(t){let c=t.target&&t.target.tagName?t.target.tagName.toUpperCase():"";if(t.ctrlKey||t.metaKey||t.altKey||c==="INPUT"||c==="TEXTAREA"||t.target.isContentEditable)return;let y=t.code||"";if(y==="PageUp"){t.preventDefault();let m=nt();m>=0&&_(m)}else if(y==="PageDown"){t.preventDefault();let m=N();m>=0&&_(m)}}))}var It={};function kt(){try{let e=new URL(It.url).pathname.match(/\/static\/players\/([^\/]+)\//);if(e&&e[1])return e[1]}catch(n){}try{let e=(document.currentScript&&document.currentScript.src||"").match(/\/static\/players\/([^\/]+)\//);if(e&&e[1])return e[1]}catch(n){}try{let n=document.querySelector(".player-host[data-player]");if(n){let e=String(n.getAttribute("data-player")||"").trim();if(e)return e}}catch(n){}return"standard"}function Et(n,e){let d=null;try{d=n.play()}catch(u){e&&e("play threw",u),d=null}d&&typeof d.then=="function"?d.then(function(){e&&e("play resolved")}).catch(function(u){if(e&&e("play rejected",{name:u&&u.name,msg:u&&u.message}),!n.muted){n.muted=!0,n.setAttribute("muted","");try{n.play()}catch(g){}}}):setTimeout(function(){if(n.paused){n.muted=!0,n.setAttribute("muted","");try{n.play()}catch(u){}}},0)}function ht(){let n=kt(),e="/static/players/"+n,d=document.querySelectorAll('.player-host[data-player="'+n+'"]');d.length!==0&&fetch(e+"/templates/player.html",{credentials:"same-origin"}).then(u=>u.text()).then(function(u){for(let g=0;g<d.length;g++)Tt(d[g],u,e)}).catch(function(){})}function Tt(n,e,d){n.innerHTML=e;let u=n.querySelector(".yrp-container"),g=u.querySelector(".yrp-video-wrap"),r=u.querySelector(".yrp-video"),A=r.querySelector("source"),w=u.querySelector(".yrp-center-play"),M=u.querySelector(".yrp-center-logo"),q=n.getAttribute("data-video-src")||"",X=n.getAttribute("data-poster-url")||"",B=mt(n,"data-subtitles",[]),p=mt(n,"data-options",{}),L=n.getAttribute("data-sprites-vtt")||"",$=n.getAttribute("data-caption-vtt")||"",S=n.getAttribute("data-caption-lang")||"",k=/\byrpdebug=1\b/i.test(location.search)||!!(p&&p.debug);function v(){if(k)try{}catch(a){}}let N=null;function nt(){if(N)return N;try{typeof Intl!="undefined"&&Intl.DisplayNames&&(N=new Intl.DisplayNames(["en"],{type:"language"}))}catch(a){}return N}function _(a,i){let s=String(a||"").trim();if(!s)return String(i||"");if(s.toLowerCase()==="auto")return"Auto";let o=s.split("-",1)[0].toLowerCase();try{let l=nt();if(l&&typeof l.of=="function"){let t=l.of(o);if(t)return t.charAt(0).toUpperCase()+t.slice(1)}}catch(l){}return String(i||s)}if(M&&M.setAttribute("src",d+"/img/logo.png"),A&&A.setAttribute("src",q),X&&r.setAttribute("poster",X),p&&p.muted&&r.setAttribute("muted",""),p&&p.loop&&r.setAttribute("loop",""),r.setAttribute("playsinline",""),r.setAttribute("controls",""),Array.isArray(B)&&B.forEach(function(a){if(!a||!a.src)return;let i=document.createElement("track");i.setAttribute("kind","subtitles"),a.srclang&&i.setAttribute("srclang",String(a.srclang));let s=String(a.srclang||"").toLowerCase(),o=String(a.label||s||"Subtitles");i.setAttribute("label",_(s,o)+(s?` (${s})`:"")),i.setAttribute("src",String(a.src)),a.default&&i.setAttribute("default",""),r.appendChild(i)}),$)try{let a=document.createElement("track");a.setAttribute("kind","subtitles"),a.setAttribute("src",$),a.setAttribute("srclang",S||"auto");let i=String(S||"auto").toLowerCase(),s=String(S||"Original");a.setAttribute("label",_(i,s)+(i?` (${i})`:"")),a.setAttribute("default",""),r.appendChild(a)}catch(a){v("caption track append failed",a)}let b=function(){try{return String(localStorage.getItem("subtitle_lang")||"")}catch(a){return""}}();function T(){try{return r.textTracks?Array.prototype.filter.call(r.textTracks,function(a){return a.kind==="subtitles"||a.kind==="captions"}):[]}catch(a){return[]}}function G(){return T().map(function(i,s){let o=String(i.language||i.srclang||"").toLowerCase(),l=String(i.label||o||"Lang "+(s+1));return{index:s,lang:o,label:l,track:i}})}function V(a){let i=String(a||"").toLowerCase(),s=G();for(let o=0;o<s.length;o++)if(s[o].lang===i||s[o].label.toLowerCase()===i)return s[o].index;return-1}function R(a){let i=T();if(!i.length)return;let s=Math.max(0,Math.min(a,i.length-1));for(let o=0;o<i.length;o++)i[o].mode=o===s?"showing":"disabled"}function j(a){let i=V(a);if(i>=0){R(i);try{localStorage.setItem("subtitle_lang",String(a||""))}catch(s){}}}function I(){try{let a=T();for(let i=0;i<a.length;i++){let s=a[i];if(s.mode==="showing"){let o=String(s.language||s.srclang||"").toLowerCase();if(o)try{localStorage.setItem("subtitle_lang",o)}catch(l){}return}}}catch(a){}}function ct(){try{let a=T();if(!a||a.length===0)return;if(b){let o=V(b);if(o>=0){R(o);return}}let i=!!(p&&p.subtitles===!0),s=!1;for(let o=0;o<a.length;o++){let l=a[o],t=i||String(l.language||l.srclang||"")===(S||l.srclang);!s&&t?(l.mode="showing",s=!0):l.mode="disabled"}if(!s)for(let o=0;o<a.length;o++){a[o].mode="showing";break}}catch(a){}}try{r.load(),v("video.load() called",{src:q})}catch(a){v("video.load() error",a)}xt(r,A,v);function W(){r.paused?u.classList.remove("playing"):u.classList.add("playing")}["loadedmetadata","loadeddata","canplay","canplaythrough","play","playing","pause","stalled","suspend","waiting","error","abort","emptied"].forEach(function(a){r.addEventListener(a,function(){v("event",a,{rs:r.readyState,paused:r.paused,muted:r.muted})})}),r.addEventListener("play",W),r.addEventListener("pause",W),r.addEventListener("loadedmetadata",function(){ct();try{let a=T();for(let i=0;i<a.length;i++){let s=a[i];s.addEventListener&&s.addEventListener("cuechange",I)}}catch(a){}r.addEventListener("timeupdate",throttle(I,800),{passive:!0})});let H=!1;function rt(){H||(H=!0,setTimeout(function(){H=!1},180),r.paused?Et(r,v):r.pause())}w&&w.addEventListener("click",function(){rt()});function lt(a){let i=a.target,s=i&&i.tagName?i.tagName.toUpperCase():"";if(i&&(i.isContentEditable||s==="INPUT"||s==="TEXTAREA")||a.ctrlKey||a.metaKey||a.altKey)return;let o=(a.key||"").toLowerCase(),l=a.code||"";if(o==="j"||l==="ArrowLeft")a.preventDefault(),r.currentTime=Math.max(0,(r.currentTime||0)-5);else if(o==="l"||l==="ArrowRight"){a.preventDefault();let t=isFinite(r.duration)?r.duration:1e9;r.currentTime=Math.min((r.currentTime||0)+5,t)}else o==="m"?(a.preventDefault(),r.muted=!r.muted):o==="f"&&(a.preventDefault(),document.fullscreenElement?document.exitFullscreen().catch(function(){}):u.requestFullscreen&&u.requestFullscreen().catch(function(){}))}document.addEventListener("keydown",lt),function(){let a=!!(p&&p.autoplay===!0);if(v("autoplay check",{WANT:a,opt:p}),!a)return;function i(o){v("autoplay attempt",o),Et(r,v)}r.readyState>=1&&i("readyState>=1");let s=function(){r.removeEventListener("canplay",s),i("canplay")};r.addEventListener("canplay",s),setTimeout(function(){r.paused&&i("watchdog")},1200)}(),function(){let a=0;if(p&&typeof p.start=="number"&&p.start>0&&(a=Math.max(0,p.start)),!a)return;let i=function(){try{r.currentTime=Math.min(a,Math.floor(r.duration||a))}catch(s){}};isFinite(r.duration)&&r.duration>0?i():r.addEventListener("loadedmetadata",function s(){r.removeEventListener("loadedmetadata",s),i()})}(),function(){let i=[],s=!1,o=!1,l=null,t=0,c=160,y=90;function m(h){let f=String(h||"").match(/^(\d{2}):(\d{2}):(\d{2}\.\d{3})$/);if(!f)return 0;let x=parseInt(f[1],10),U=parseInt(f[2],10),D=parseFloat(f[3]);return x*3600+U*60+D}function ut(h,f){if(!f)return"";if(/^https?:\/\//i.test(f)||f.startsWith("/"))return f;try{return new URL(h,window.location.origin).pathname.replace(/\/sprites\.vtt$/,"")+"/"+f.replace(/^\/+/,"")}catch(x){return f}}function at(){return document.fullscreenElement||g||u}function z(){if(l)return l;l=document.createElement("div"),l.className="std-sprite-pop",l.style.pointerEvents="none",l.style.display="none",l.style.border="1px solid #333",l.style.background="#000",l.style.overflow="hidden",l.style.boxShadow="0 4px 12px rgba(0,0,0,.4)",l.style.borderRadius="4px",l.style.zIndex="9999";let h=at();if(document.fullscreenElement)l.style.position="fixed",h.appendChild(l);else{l.style.position="absolute";let f=h;getComputedStyle(f).position==="static"&&(f.style.position="relative"),f.appendChild(l)}return l}document.addEventListener("fullscreenchange",function(){if(!l)return;let h=at();try{h.appendChild(l),l.style.position=document.fullscreenElement?"fixed":"absolute"}catch(f){}});function gt(){!L||s||o||fetch(L,{credentials:"same-origin"}).then(h=>h.text()).then(function(h){let f=h.split(/\r?\n/);for(let x=0;x<f.length;x++){let U=f[x].trim();if(U&&U.indexOf("-->")>=0){let D=U.split("-->").map(P=>P.trim());if(D.length<2)continue;let Y=m(D[0]),K=m(D[1]),it=(f[x+1]||"").trim(),Q="",E=0,C=0,F=0,Z=0,O=it.indexOf("#xywh=");if(O>0){Q=it.substring(0,O);let P=it.substring(O+6).split(",");P.length===4&&(E=parseInt(P[0],10),C=parseInt(P[1],10),F=parseInt(P[2],10),Z=parseInt(P[3],10))}let tt=ut(L,Q);i.push({start:Y,end:K,spriteUrl:tt,x:E,y:C,w:F,h:Z}),K>t&&(t=K),x++}}s=!0,v("sprites VTT loaded (standard)",{cues:i.length,durationApprox:t})}).catch(function(h){o=!0,v("sprites VTT load failed (standard)",h)})}function Ct(h){if(!L||!i.length)return;let f=r.getBoundingClientRect(),x=at().getBoundingClientRect(),U=Math.max(36,Math.min(140,Math.round(f.height*.12))),D=h.clientX,Y=Math.max(f.left,Math.min(D,f.right)),K=f.width>0?(Y-f.left)/f.width:0;K=Math.max(0,Math.min(1,K));let Q=(isFinite(r.duration)&&r.duration>0?r.duration:t)*K,E=null;for(let dt=0;dt<i.length;dt++){let pt=i[dt];if(Q>=pt.start&&Q<pt.end){E=pt;break}}let C=z();if(!E||!E.spriteUrl){C.style.display="none";return}let F=E.w>0?E.w:c,Z=E.h>0?E.h:y;for(;C.firstChild;)C.removeChild(C.firstChild);let O=document.createElement("img");O.src=E.spriteUrl,O.style.position="absolute",O.style.left=-E.x+"px",O.style.top=-E.y+"px",O.style.pointerEvents="none",C.appendChild(O),C.style.display="block",C.style.width=F+"px",C.style.height=Z+"px";let tt=!!document.fullscreenElement,P=tt?yt(Y-F/2,x.left,x.right-F):yt(Y-x.left-F/2,f.left-x.left,f.right-x.left-F),ft=f.bottom-(tt?0:x.top)-Z-U;tt||(ft=Math.max(0,ft)),C.style.left=P+"px",C.style.top=ft+"px"}L&&(r.addEventListener("loadedmetadata",function(){gt()}),setTimeout(function(){!s&&!o&&gt()},2500),r.addEventListener("mousemove",function(h){s&&Ct(h)}),r.addEventListener("mouseleave",function(){l&&(l.style.display="none")}))}(),St({root:u,video:r,DEBUG:k}),W()}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",ht):ht();})();
