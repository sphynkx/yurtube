(()=>{function V(i,c,d){let s=i.getAttribute(c);if(!s)return d;try{return JSON.parse(s)}catch(m){return d}}var tt="/static/img/fallback_video_notfound.gif";function et(i,c,d){let s=!1,m=null;function e(L){if(!s){s=!0,d&&d("fallback: applying",L);try{c?c.setAttribute("src",tt):i.src=tt,i.load()}catch(q){}}}function v(){m&&(clearTimeout(m),m=null)}i.addEventListener("loadstart",function(){v(),m=setTimeout(function(){!s&&i.readyState<1&&e("watchdog-timeout")},4e3)}),["loadeddata","canplay","canplaythrough","play","playing"].forEach(function(L){i.addEventListener(L,v)}),i.addEventListener("error",function(){s||e("error-event")}),setTimeout(function(){let L=c?c.getAttribute("src")||"":i.currentSrc||i.src||"";!s&&!L&&e("empty-src")},0)}var wt={};function gt(){try{let c=new URL(wt.url).pathname.match(/\/static\/players\/([^\/]+)\//);if(c&&c[1])return c[1]}catch(i){}try{let c=(document.currentScript&&document.currentScript.src||"").match(/\/static\/players\/([^\/]+)\//);if(c&&c[1])return c[1]}catch(i){}try{let i=document.querySelector(".player-host[data-player]");if(i){let c=String(i.getAttribute("data-player")||"").trim();if(c)return c}}catch(i){}return"standard"}function nt(i,c){let d=null;try{d=i.play()}catch(s){c&&c("play threw",s),d=null}d&&typeof d.then=="function"?d.then(function(){c&&c("play resolved")}).catch(function(s){if(c&&c("play rejected",{name:s&&s.name,msg:s&&s.message}),!i.muted){i.muted=!0,i.setAttribute("muted","");try{i.play()}catch(m){}}}):setTimeout(function(){if(i.paused){i.muted=!0,i.setAttribute("muted","");try{i.play()}catch(s){}}},0)}function W(){let i=gt(),c="/static/players/"+i,d=document.querySelectorAll('.player-host[data-player="'+i+'"]');d.length!==0&&fetch(c+"/templates/player.html",{credentials:"same-origin"}).then(s=>s.text()).then(function(s){for(let m=0;m<d.length;m++)bt(d[m],s,c)}).catch(function(){})}function bt(i,c,d){i.innerHTML=c;let s=i.querySelector(".yrp-container"),m=s.querySelector(".yrp-video-wrap"),e=s.querySelector(".yrp-video"),v=e.querySelector("source"),L=s.querySelector(".yrp-center-play"),q=s.querySelector(".yrp-center-logo"),X=i.getAttribute("data-video-src")||"",j=i.getAttribute("data-poster-url")||"",G=V(i,"data-subtitles",[]),p=V(i,"data-options",{}),C=i.getAttribute("data-sprites-vtt")||"",J=i.getAttribute("data-caption-vtt")||"",R=i.getAttribute("data-caption-lang")||"",rt=/\byrpdebug=1\b/i.test(location.search)||!!(p&&p.debug);function b(){if(rt)try{}catch(t){}}let U=null;function it(){if(U)return U;try{typeof Intl!="undefined"&&Intl.DisplayNames&&(U=new Intl.DisplayNames(["en"],{type:"language"}))}catch(t){}return U}function z(t,n){let r=String(t||"").trim();if(!r)return String(n||"");if(r.toLowerCase()==="auto")return"Auto";let a=r.split("-",1)[0].toLowerCase();try{let o=it();if(o&&typeof o.of=="function"){let g=o.of(a);if(g)return g.charAt(0).toUpperCase()+g.slice(1)}}catch(o){}return String(n||r)}if(q&&q.setAttribute("src",d+"/img/logo.png"),v&&v.setAttribute("src",X),j&&e.setAttribute("poster",j),p&&p.muted&&e.setAttribute("muted",""),p&&p.loop&&e.setAttribute("loop",""),e.setAttribute("playsinline",""),e.setAttribute("controls",""),Array.isArray(G)&&G.forEach(function(t){if(!t||!t.src)return;let n=document.createElement("track");n.setAttribute("kind","subtitles"),t.srclang&&n.setAttribute("srclang",String(t.srclang));let r=String(t.srclang||"").toLowerCase(),a=String(t.label||r||"Subtitles");n.setAttribute("label",z(r,a)+(r?` (${r})`:"")),n.setAttribute("src",String(t.src)),t.default&&n.setAttribute("default",""),e.appendChild(n)}),J)try{let t=document.createElement("track");t.setAttribute("kind","subtitles"),t.setAttribute("src",J),t.setAttribute("srclang",R||"auto");let n=String(R||"auto").toLowerCase(),r=String(R||"Original");t.setAttribute("label",z(n,r)+(n?` (${n})`:"")),t.setAttribute("default",""),e.appendChild(t)}catch(t){b("caption track append failed",t)}let Y=function(){try{return String(localStorage.getItem("subtitle_lang")||"")}catch(t){return""}}();function k(){try{return e.textTracks?Array.prototype.filter.call(e.textTracks,function(t){return t.kind==="subtitles"||t.kind==="captions"}):[]}catch(t){return[]}}function at(){return k().map(function(n,r){let a=String(n.language||n.srclang||"").toLowerCase(),o=String(n.label||a||"Lang "+(r+1));return{index:r,lang:a,label:o,track:n}})}function ot(t){let n=String(t||"").toLowerCase(),r=at();for(let a=0;a<r.length;a++)if(r[a].lang===n||r[a].label.toLowerCase()===n)return r[a].index;return-1}function st(t){let n=k();if(!n.length)return;let r=Math.max(0,Math.min(t,n.length-1));for(let a=0;a<n.length;a++)n[a].mode=a===r?"showing":"disabled"}function ct(){try{let t=k();if(!t||t.length===0)return;if(Y){let a=ot(Y);if(a>=0){st(a);return}}let n=!!(p&&p.subtitles===!0),r=!1;for(let a=0;a<t.length;a++){let o=t[a],g=n||String(o.language||o.srclang||"")===(R||o.srclang);!r&&g?(o.mode="showing",r=!0):o.mode="disabled"}r||(t[0].mode="showing")}catch(t){}}function lt(){try{let t=k();for(let n=0;n<t.length;n++){let r=t[n];if(r.mode==="showing"){let a=String(r.language||r.srclang||"").toLowerCase();if(a)try{localStorage.setItem("subtitle_lang",a)}catch(o){}return}}}catch(t){}}try{e.load(),b("video.load() called",{src:X})}catch(t){b("video.load() error",t)}et(e,v,b);function B(){e.paused?s.classList.remove("playing"):s.classList.add("playing")}["loadedmetadata","loadeddata","canplay","canplaythrough","play","pause","stalled","suspend","waiting","error","abort","emptied"].forEach(function(t){e.addEventListener(t,function(){b("event",t,{rs:e.readyState,paused:e.paused,muted:e.muted})})}),e.addEventListener("play",B),e.addEventListener("pause",B),e.addEventListener("loadedmetadata",function(){ct();try{let t=k();for(let n=0;n<t.length;n++){let r=t[n];r.addEventListener&&r.addEventListener("cuechange",lt)}}catch(t){}});function M(){try{let t=window.innerHeight||document.documentElement.clientHeight||s.clientHeight||0;if(t<=0)return;m.style.height=t+"px",e.style.height="100%",e.style.width="100%",e.style.objectFit="contain"}catch(t){}}window.addEventListener("resize",M),window.addEventListener("orientationchange",M),M(),setTimeout(M,0),setTimeout(M,100);let D=!1;function ut(){D||(D=!0,setTimeout(function(){D=!1},180),e.paused?nt(e,b):e.pause())}L&&L.addEventListener("click",function(){ut()});function dt(t){let n=t.target,r=n&&n.tagName?n.tagName.toUpperCase():"";if(n&&(n.isContentEditable||r==="INPUT"||r==="TEXTAREA")||t.ctrlKey||t.metaKey||t.altKey)return;let a=(t.key||"").toLowerCase(),o=t.code||"";if(a==="j"||o==="ArrowLeft")t.preventDefault(),e.currentTime=Math.max(0,(e.currentTime||0)-5);else if(a==="l"||o==="ArrowRight"){t.preventDefault();let g=isFinite(e.duration)?e.duration:1e9;e.currentTime=Math.min((e.currentTime||0)+5,g)}else a==="m"?(t.preventDefault(),e.muted=!e.muted):a==="f"&&(t.preventDefault(),document.fullscreenElement?document.exitFullscreen().catch(function(){}):s.requestFullscreen&&s.requestFullscreen().catch(function(){}))}document.addEventListener("keydown",dt),function(){let t=!!(p&&p.autoplay===!0);if(b("autoplay check (embed)",{WANT:t,opt:p}),!t)return;function n(a){b("autoplay attempt",a),nt(e,b)}e.readyState>=1&&n("readyState>=1");let r=function(){e.removeEventListener("canplay",r),n("canplay")};e.addEventListener("canplay",r),setTimeout(function(){e.paused&&n("watchdog")},1200)}(),function(){let t=0;if(p&&typeof p.start=="number"&&p.start>0&&(t=Math.max(0,p.start)),!t)return;let n=function(){try{e.currentTime=Math.min(t,Math.floor(e.duration||t))}catch(r){}};isFinite(e.duration)&&e.duration>0?n():e.addEventListener("loadedmetadata",function r(){e.removeEventListener("loadedmetadata",r),n()})}(),function(){let n=[],r=!1,a=!1,o=null,g=0,ft=160,pt=90;function Q(u){let l=String(u||"").match(/^(\d{2}):(\d{2}):(\d{2}\.\d{3})$/);if(!l)return 0;let f=parseInt(l[1],10),A=parseInt(l[2],10),E=parseFloat(l[3]);return f*3600+A*60+E}function mt(u,l){if(!l)return"";if(/^https?:\/\//i.test(l)||l.startsWith("/"))return l;try{return new URL(u,window.location.origin).pathname.replace(/\/sprites\.vtt$/,"")+"/"+l.replace(/^\/+/,"")}catch(f){return l}}function $(){return document.fullscreenElement||m||s}function yt(){if(o)return o;o=document.createElement("div"),o.className="std-embed-sprite-pop",o.style.pointerEvents="none",o.style.display="none",o.style.border="1px solid #333",o.style.background="#000",o.style.overflow="hidden",o.style.boxShadow="0 4px 12px rgba(0,0,0,.4)",o.style.borderRadius="4px",o.style.zIndex="9999";let u=$();return document.fullscreenElement?(o.style.position="fixed",u.appendChild(o)):(o.style.position="absolute",getComputedStyle(u).position==="static"&&(u.style.position="relative"),u.appendChild(o)),o}document.addEventListener("fullscreenchange",function(){if(!o)return;let u=$();try{u.appendChild(o),o.style.position=document.fullscreenElement?"fixed":"absolute"}catch(l){}});function Z(){!C||r||a||fetch(C,{credentials:"same-origin"}).then(u=>u.text()).then(function(u){let l=u.split(/\r?\n/);for(let f=0;f<l.length;f++){let A=l[f].trim();if(A&&A.indexOf("-->")>=0){let E=A.split("-->").map(x=>x.trim());if(E.length<2)continue;let F=Q(E[0]),T=Q(E[1]),_=(l[f+1]||"").trim(),I="",y=0,h=0,S=0,N=0,w=_.indexOf("#xywh=");if(w>0){I=_.substring(0,w);let x=_.substring(w+6).split(",");x.length===4&&(y=parseInt(x[0],10),h=parseInt(x[1],10),S=parseInt(x[2],10),N=parseInt(x[3],10))}let P=mt(C,I);n.push({start:F,end:T,spriteUrl:P,x:y,y:h,w:S,h:N}),T>g&&(g=T),f++}}r=!0,b("sprites VTT loaded (std-embed)",{cues:n.length,durationApprox:g})}).catch(function(u){a=!0,b("sprites VTT load failed (std-embed)",u)})}function ht(u){if(!C||!n.length)return;let l=e.getBoundingClientRect(),f=$().getBoundingClientRect(),A=Math.max(36,Math.min(140,Math.round(l.height*.12))),E=u.clientX,F=Math.max(l.left,Math.min(E,l.right)),T=l.width>0?(F-l.left)/l.width:0;T=Math.max(0,Math.min(1,T));let I=(isFinite(e.duration)&&e.duration>0?e.duration:g)*T,y=null;for(let O=0;O<n.length;O++){let K=n[O];if(I>=K.start&&I<K.end){y=K;break}}let h=yt();if(!y||!y.spriteUrl){h.style.display="none";return}let S=y.w>0?y.w:ft,N=y.h>0?y.h:pt;for(;h.firstChild;)h.removeChild(h.firstChild);let w=document.createElement("img");w.src=y.spriteUrl,w.style.position="absolute",w.style.left=-y.x+"px",w.style.top=-y.y+"px",w.style.pointerEvents="none",h.appendChild(w),h.style.display="block",h.style.width=S+"px",h.style.height=N+"px";let P=!!document.fullscreenElement,x=P?clamp(F-S/2,f.left,f.right-S):clamp(F-f.left-S/2,l.left-f.left,l.right-f.left-S),H=l.bottom-(P?0:f.top)-N-A;P||(H=Math.max(0,H)),h.style.left=x+"px",h.style.top=H+"px"}C&&(e.addEventListener("loadedmetadata",function(){Z()}),setTimeout(function(){!r&&!a&&Z()},2500),e.addEventListener("mousemove",function(u){r&&ht(u)}),e.addEventListener("mouseleave",function(){o&&(o.style.display="none")}))}(),B()}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",W):W();})();
