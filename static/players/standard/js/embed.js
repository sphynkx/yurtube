(()=>{function v(t,r,e){let o=t.getAttribute(r);if(!o)return e;try{return JSON.parse(o)}catch(y){return e}}var N="/static/img/fallback_video_notfound.gif";function R(t,r,e){let o=!1,y=null;function c(m){if(!o){o=!0,e&&e("fallback: applying",m);try{r?r.setAttribute("src",N):t.src=N,t.load()}catch(w){}}}function b(){y&&(clearTimeout(y),y=null)}t.addEventListener("loadstart",function(){b(),y=setTimeout(function(){!o&&t.readyState<1&&c("watchdog-timeout")},4e3)}),["loadeddata","canplay","canplaythrough","play","playing"].forEach(function(m){t.addEventListener(m,b)}),t.addEventListener("error",function(){o||c("error-event")}),setTimeout(function(){let m=r?r.getAttribute("src")||"":t.currentSrc||t.src||"";!o&&!m&&c("empty-src")},0)}var H={};function D(){try{let r=new URL(H.url).pathname.match(/\/static\/players\/([^\/]+)\//);if(r&&r[1])return r[1]}catch(t){}try{let r=(document.currentScript&&document.currentScript.src||"").match(/\/static\/players\/([^\/]+)\//);if(r&&r[1])return r[1]}catch(t){}try{let t=document.querySelector(".player-host[data-player]");if(t){let r=String(t.getAttribute("data-player")||"").trim();if(r)return r}}catch(t){}return"standard"}function O(t,r){let e=null;try{e=t.play()}catch(o){r&&r("play threw",o),e=null}e&&typeof e.then=="function"?e.then(function(){r&&r("play resolved")}).catch(function(o){if(r&&r("play rejected",{name:o&&o.name,msg:o&&o.message}),!t.muted){t.muted=!0,t.setAttribute("muted","");try{t.play()}catch(y){}}}):setTimeout(function(){if(t.paused){t.muted=!0,t.setAttribute("muted","");try{t.play()}catch(o){}}},0)}function P({root:t,host:r,video:e,DEBUG:o}){let y=(...a)=>{if(o)try{}catch(i){}},c=v(r,"data-sources",[]),b=String(r.getAttribute("data-permit-download")||"").trim()==="1",m=v(r,"data-download-items",[]),w=t.querySelector(".yrp-video-wrap"),S=t.querySelector('.std-ext-media[data-std-media="1"]');if(!w||!S)return;let E=Array.isArray(c)&&c.filter(a=>a&&a.src).length>1,L=!!b&&Array.isArray(m)&&m.length>0;if(!E&&!L)return;try{getComputedStyle(w).position==="static"&&(w.style.position="relative")}catch(a){}S.innerHTML="",Object.assign(S.style,{position:"absolute",right:"12px",top:"12px",display:"flex",flexDirection:"column",gap:"6px",zIndex:"30",pointerEvents:"auto",alignItems:"flex-end"});function g(a){let i=document.createElement("div");Object.assign(i.style,{display:"flex",gap:"6px",alignItems:"center",background:"rgba(0,0,0,0.45)",border:"1px solid rgba(255,255,255,0.12)",padding:"6px 8px",borderRadius:"8px",color:"#fff",fontSize:"12px",lineHeight:"1",backdropFilter:"blur(2px)"});let u=document.createElement("div");return u.textContent=a,u.style.opacity="0.9",u.style.whiteSpace="nowrap",i.appendChild(u),{row:i}}function q(){let a=document.createElement("select");return Object.assign(a.style,{fontSize:"12px",padding:"3px 6px",borderRadius:"6px",border:"1px solid rgba(255,255,255,0.22)",background:"rgba(0,0,0,0.55)",color:"#fff",outline:"none"}),a}function C(){try{let a=e.querySelector("source");return a&&(a.getAttribute("src")||a.src)?String(a.getAttribute("src")||a.src||""):""}catch(a){return""}}let x=t.getAttribute("data-video-id")||"",T=x?"yrp:quality:"+x:"yrp:quality";function h(a){if(!a)return;let i=e.querySelector("source");if(!i)return;let u=C();if(u&&u===a)return;let l=!e.paused,f=Math.max(0,e.currentTime||0),A=isFinite(e.playbackRate)&&e.playbackRate>0?e.playbackRate:1,d=isFinite(e.volume)?e.volume:1,n=!!e.muted;try{localStorage.setItem(T,String(a))}catch(s){}try{i.setAttribute("src",String(a));try{i.src=String(a)}catch(s){}e.load()}catch(s){y("switchSource load error",s);return}let p=function(){e.removeEventListener("loadedmetadata",p);try{e.playbackRate=A}catch(s){}try{e.volume=d}catch(s){}try{e.muted=n}catch(s){}try{let s=isFinite(e.duration)?e.duration:0;if(s>0){let k=Math.min(f,Math.max(0,s-.25));e.currentTime=k}}catch(s){}if(l)try{e.play().catch(function(){})}catch(s){}};e.addEventListener("loadedmetadata",p)}if(E){let{row:a}=g("Quality"),i=q(),u=c.filter(d=>d&&d.src).map(d=>({label:String(d.label||d.preset||"Quality"),src:String(d.src||"")}));u.forEach(d=>{let n=document.createElement("option");n.value=d.src,n.textContent=d.label,i.appendChild(n)});let l=function(){try{return String(localStorage.getItem(T)||"")}catch(d){return""}}(),f=C(),A=l||f||u[0]&&u[0].src||"";A&&(i.value=A,l&&l!==f&&setTimeout(()=>h(l),0)),i.addEventListener("change",function(){let d=String(i.value||"");d&&h(d)}),a.appendChild(i),S.appendChild(a)}if(L){let{row:a}=g("Download"),i=q(),u=document.createElement("option");u.value="",u.textContent="Select\u2026",i.appendChild(u),m.forEach(l=>{if(!l||!l.url)return;let f=document.createElement("option");f.value=String(l.url||""),f.textContent=String(l.label||"Download"),i.appendChild(f)}),i.addEventListener("change",function(){let l=String(i.value||"");if(l){try{window.open(l,"_blank","noopener")}catch(f){window.location.href=l}i.value=""}}),a.appendChild(i),S.appendChild(a)}}function I(){let t=D(),r="/static/players/"+t,e=document.querySelectorAll('.player-host[data-player="'+t+'"]');e.length!==0&&fetch(r+"/templates/player.html",{credentials:"same-origin"}).then(o=>o.text()).then(function(o){for(let y=0;y<e.length;y++)_(e[y],o,r)}).catch(function(){})}function _(t,r,e){t.innerHTML=r;let o=t.querySelector(".yrp-container"),y=o.querySelector(".yrp-video-wrap"),c=o.querySelector(".yrp-video"),b=c.querySelector("source"),m=o.querySelector(".yrp-center-play"),w=o.querySelector(".yrp-center-logo"),S=t.getAttribute("data-video-src")||"",E=t.getAttribute("data-poster-url")||"",L=v(t,"data-subtitles",[]),g=v(t,"data-options",{}),q=t.getAttribute("data-sprites-vtt")||"",C=t.getAttribute("data-caption-vtt")||"",x=t.getAttribute("data-caption-lang")||"",T=/\byrpdebug=1\b/i.test(location.search)||!!(g&&g.debug);function h(){if(T)try{}catch(n){}}let a=null;function i(){if(a)return a;try{typeof Intl!="undefined"&&Intl.DisplayNames&&(a=new Intl.DisplayNames(["en"],{type:"language"}))}catch(n){}return a}function u(n,p){let s=String(n||"").trim();if(!s)return String(p||"");if(s.toLowerCase()==="auto")return"Auto";let k=s.split("-",1)[0].toLowerCase();try{let M=i();if(M&&typeof M.of=="function"){let F=M.of(k);if(F)return F.charAt(0).toUpperCase()+F.slice(1)}}catch(M){}return String(p||s)}if(w&&w.setAttribute("src",e+"/img/logo.png"),b&&b.setAttribute("src",S),E&&c.setAttribute("poster",E),g&&g.muted&&c.setAttribute("muted",""),g&&g.loop&&c.setAttribute("loop",""),c.setAttribute("playsinline",""),c.setAttribute("controls",""),Array.isArray(L)&&L.forEach(function(n){if(!n||!n.src)return;let p=document.createElement("track");p.setAttribute("kind","subtitles"),n.srclang&&p.setAttribute("srclang",String(n.srclang));let s=String(n.srclang||"").toLowerCase(),k=String(n.label||s||"Subtitles");p.setAttribute("label",u(s,k)+(s?` (${s})`:"")),p.setAttribute("src",String(n.src)),n.default&&p.setAttribute("default",""),c.appendChild(p)}),C)try{let n=document.createElement("track");n.setAttribute("kind","subtitles"),n.setAttribute("src",C),n.setAttribute("srclang",x||"auto");let p=String(x||"auto").toLowerCase(),s=String(x||"Original");n.setAttribute("label",u(p,s)+(p?` (${p})`:"")),n.setAttribute("default",""),c.appendChild(n)}catch(n){h("caption track append failed",n)}try{c.load(),h("video.load() called",{src:S})}catch(n){h("video.load() error",n)}R(c,b,h);function l(){c.paused?o.classList.remove("playing"):o.classList.add("playing")}["loadedmetadata","loadeddata","canplay","canplaythrough","play","pause","stalled","suspend","waiting","error","abort","emptied"].forEach(function(n){c.addEventListener(n,function(){h("event",n,{rs:c.readyState,paused:c.paused,muted:c.muted})})}),c.addEventListener("play",l),c.addEventListener("pause",l);function f(){try{let n=window.innerHeight||document.documentElement.clientHeight||o.clientHeight||0;if(n<=0)return;y.style.height=n+"px",c.style.height="100%",c.style.width="100%",c.style.objectFit="contain"}catch(n){}}window.addEventListener("resize",f),window.addEventListener("orientationchange",f),f(),setTimeout(f,0),setTimeout(f,100);let A=!1;function d(){A||(A=!0,setTimeout(function(){A=!1},180),c.paused?O(c,h):c.pause())}m&&m.addEventListener("click",function(){d()}),P({root:o,host:t,video:c,DEBUG:T}),l()}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",I):I();})();
