(()=>{function $(r,c,d){let s=r.getAttribute(c);if(!s)return d;try{return JSON.parse(s)}catch(m){return d}}var Q="/static/img/fallback_video_notfound.gif";function Z(r,c,d){let s=!1,m=null;function e(w){if(!s){s=!0,d&&d("fallback: applying",w);try{c?c.setAttribute("src",Q):r.src=Q,r.load()}catch(_){}}}function v(){m&&(clearTimeout(m),m=null)}r.addEventListener("loadstart",function(){v(),m=setTimeout(function(){!s&&r.readyState<1&&e("watchdog-timeout")},4e3)}),["loadeddata","canplay","canplaythrough","play","playing"].forEach(function(w){r.addEventListener(w,v)}),r.addEventListener("error",function(){s||e("error-event")}),setTimeout(function(){let w=c?c.getAttribute("src")||"":r.currentSrc||r.src||"";!s&&!w&&e("empty-src")},0)}var yt={};function mt(){try{let c=new URL(yt.url).pathname.match(/\/static\/players\/([^\/]+)\//);if(c&&c[1])return c[1]}catch(r){}try{let c=(document.currentScript&&document.currentScript.src||"").match(/\/static\/players\/([^\/]+)\//);if(c&&c[1])return c[1]}catch(r){}try{let r=document.querySelector(".player-host[data-player]");if(r){let c=String(r.getAttribute("data-player")||"").trim();if(c)return c}}catch(r){}return"standard"}function tt(r,c){let d=null;try{d=r.play()}catch(s){c&&c("play threw",s),d=null}d&&typeof d.then=="function"?d.then(function(){c&&c("play resolved")}).catch(function(s){if(c&&c("play rejected",{name:s&&s.name,msg:s&&s.message}),!r.muted){r.muted=!0,r.setAttribute("muted","");try{r.play()}catch(m){}}}):setTimeout(function(){if(r.paused){r.muted=!0,r.setAttribute("muted","");try{r.play()}catch(s){}}},0)}function D(){let r=mt(),c="/static/players/"+r,d=document.querySelectorAll('.player-host[data-player="'+r+'"]');d.length!==0&&fetch(c+"/templates/player.html",{credentials:"same-origin"}).then(s=>s.text()).then(function(s){for(let m=0;m<d.length;m++)ht(d[m],s,c)}).catch(function(){})}function ht(r,c,d){r.innerHTML=c;let s=r.querySelector(".yrp-container"),m=s.querySelector(".yrp-video-wrap"),e=s.querySelector(".yrp-video"),v=e.querySelector("source"),w=s.querySelector(".yrp-center-play"),_=s.querySelector(".yrp-center-logo"),W=r.getAttribute("data-video-src")||"",X=r.getAttribute("data-poster-url")||"",j=$(r,"data-subtitles",[]),p=$(r,"data-options",{}),C=r.getAttribute("data-sprites-vtt")||"",G=r.getAttribute("data-caption-vtt")||"",N=r.getAttribute("data-caption-lang")||"",et=/\byrpdebug=1\b/i.test(location.search)||!!(p&&p.debug);function g(){if(et)try{}catch(t){}}if(_&&_.setAttribute("src",d+"/img/logo.png"),v&&v.setAttribute("src",W),X&&e.setAttribute("poster",X),p&&p.muted&&e.setAttribute("muted",""),p&&p.loop&&e.setAttribute("loop",""),e.setAttribute("playsinline",""),e.setAttribute("controls",""),Array.isArray(j)&&j.forEach(function(t){if(!t||!t.src)return;let n=document.createElement("track");n.setAttribute("kind","subtitles"),t.srclang&&n.setAttribute("srclang",String(t.srclang)),t.label&&n.setAttribute("label",String(t.label)),n.setAttribute("src",String(t.src)),t.default&&n.setAttribute("default",""),e.appendChild(n)}),G)try{let t=document.createElement("track");t.setAttribute("kind","subtitles"),t.setAttribute("src",G),t.setAttribute("srclang",N||"auto"),t.setAttribute("label",N||"Original"),t.setAttribute("default",""),e.appendChild(t)}catch(t){g("caption track append failed",t)}let J=function(){try{return String(localStorage.getItem("subtitle_lang")||"")}catch(t){return""}}();function k(){try{return e.textTracks?Array.prototype.filter.call(e.textTracks,function(t){return t.kind==="subtitles"||t.kind==="captions"}):[]}catch(t){return[]}}function nt(){return k().map(function(n,i){let a=String(n.language||n.srclang||"").toLowerCase(),o=String(n.label||a||"Lang "+(i+1));return{index:i,lang:a,label:o,track:n}})}function rt(t){let n=String(t||"").toLowerCase(),i=nt();for(let a=0;a<i.length;a++)if(i[a].lang===n||i[a].label.toLowerCase()===n)return i[a].index;return-1}function it(t){let n=k();if(!n.length)return;let i=Math.max(0,Math.min(t,n.length-1));for(let a=0;a<n.length;a++)n[a].mode=a===i?"showing":"disabled"}function at(){try{let t=k();if(!t||t.length===0)return;if(J){let a=rt(J);if(a>=0){it(a);return}}let n=!!(p&&p.subtitles===!0),i=!1;for(let a=0;a<t.length;a++){let o=t[a],A=n||String(o.language||o.srclang||"")===(N||o.srclang);!i&&A?(o.mode="showing",i=!0):o.mode="disabled"}i||(t[0].mode="showing")}catch(t){}}function ot(){try{let t=k();for(let n=0;n<t.length;n++){let i=t[n];if(i.mode==="showing"){let a=String(i.language||i.srclang||"").toLowerCase();if(a)try{localStorage.setItem("subtitle_lang",a)}catch(o){}return}}}catch(t){}}try{e.load(),g("video.load() called",{src:W})}catch(t){g("video.load() error",t)}Z(e,v,g);function q(){e.paused?s.classList.remove("playing"):s.classList.add("playing")}["loadedmetadata","loadeddata","canplay","canplaythrough","play","pause","stalled","suspend","waiting","error","abort","emptied"].forEach(function(t){e.addEventListener(t,function(){g("event",t,{rs:e.readyState,paused:e.paused,muted:e.muted})})}),e.addEventListener("play",q),e.addEventListener("pause",q),e.addEventListener("loadedmetadata",function(){at();try{let t=k();for(let n=0;n<t.length;n++){let i=t[n];i.addEventListener&&i.addEventListener("cuechange",ot)}}catch(t){}});function M(){try{let t=window.innerHeight||document.documentElement.clientHeight||s.clientHeight||0;if(t<=0)return;m.style.height=t+"px",e.style.height="100%",e.style.width="100%",e.style.objectFit="contain"}catch(t){}}window.addEventListener("resize",M),window.addEventListener("orientationchange",M),M(),setTimeout(M,0),setTimeout(M,100);let B=!1;function st(){B||(B=!0,setTimeout(function(){B=!1},180),e.paused?tt(e,g):e.pause())}w&&w.addEventListener("click",function(){st()});function ct(t){let n=t.target,i=n&&n.tagName?n.tagName.toUpperCase():"";if(n&&(n.isContentEditable||i==="INPUT"||i==="TEXTAREA")||t.ctrlKey||t.metaKey||t.altKey)return;let a=(t.key||"").toLowerCase(),o=t.code||"";if(a==="j"||o==="ArrowLeft")t.preventDefault(),e.currentTime=Math.max(0,(e.currentTime||0)-5);else if(a==="l"||o==="ArrowRight"){t.preventDefault();let A=isFinite(e.duration)?e.duration:1e9;e.currentTime=Math.min((e.currentTime||0)+5,A)}else a==="m"?(t.preventDefault(),e.muted=!e.muted):a==="f"&&(t.preventDefault(),document.fullscreenElement?document.exitFullscreen().catch(function(){}):s.requestFullscreen&&s.requestFullscreen().catch(function(){}))}document.addEventListener("keydown",ct),function(){let t=!!(p&&p.autoplay===!0);if(g("autoplay check (embed)",{WANT:t,opt:p}),!t)return;function n(a){g("autoplay attempt",a),tt(e,g)}e.readyState>=1&&n("readyState>=1");let i=function(){e.removeEventListener("canplay",i),n("canplay")};e.addEventListener("canplay",i),setTimeout(function(){e.paused&&n("watchdog")},1200)}(),function(){let t=0;if(p&&typeof p.start=="number"&&p.start>0&&(t=Math.max(0,p.start)),!t)return;let n=function(){try{e.currentTime=Math.min(t,Math.floor(e.duration||t))}catch(i){}};isFinite(e.duration)&&e.duration>0?n():e.addEventListener("loadedmetadata",function i(){e.removeEventListener("loadedmetadata",i),n()})}(),function(){let n=[],i=!1,a=!1,o=null,A=0,lt=160,ut=90;function z(u){let l=String(u||"").match(/^(\d{2}):(\d{2}):(\d{2}\.\d{3})$/);if(!l)return 0;let f=parseInt(l[1],10),L=parseInt(l[2],10),S=parseFloat(l[3]);return f*3600+L*60+S}function dt(u,l){if(!l)return"";if(/^https?:\/\//i.test(l)||l.startsWith("/"))return l;try{return new URL(u,window.location.origin).pathname.replace(/\/sprites\.vtt$/,"")+"/"+l.replace(/^\/+/,"")}catch(f){return l}}function H(){return document.fullscreenElement||m||s}function ft(){if(o)return o;o=document.createElement("div"),o.className="std-embed-sprite-pop",o.style.pointerEvents="none",o.style.display="none",o.style.border="1px solid #333",o.style.background="#000",o.style.overflow="hidden",o.style.boxShadow="0 4px 12px rgba(0,0,0,.4)",o.style.borderRadius="4px",o.style.zIndex="9999";let u=H();return document.fullscreenElement?(o.style.position="fixed",u.appendChild(o)):(o.style.position="absolute",getComputedStyle(u).position==="static"&&(u.style.position="relative"),u.appendChild(o)),o}document.addEventListener("fullscreenchange",function(){if(!o)return;let u=H();try{u.appendChild(o),o.style.position=document.fullscreenElement?"fixed":"absolute"}catch(l){}});function Y(){!C||i||a||fetch(C,{credentials:"same-origin"}).then(u=>u.text()).then(function(u){let l=u.split(/\r?\n/);for(let f=0;f<l.length;f++){let L=l[f].trim();if(L&&L.indexOf("-->")>=0){let S=L.split("-->").map(x=>x.trim());if(S.length<2)continue;let F=z(S[0]),T=z(S[1]),U=(l[f+1]||"").trim(),I="",h=0,y=0,E=0,P=0,b=U.indexOf("#xywh=");if(b>0){I=U.substring(0,b);let x=U.substring(b+6).split(",");x.length===4&&(h=parseInt(x[0],10),y=parseInt(x[1],10),E=parseInt(x[2],10),P=parseInt(x[3],10))}let R=dt(C,I);n.push({start:F,end:T,spriteUrl:R,x:h,y,w:E,h:P}),T>A&&(A=T),f++}}i=!0,g("sprites VTT loaded (std-embed)",{cues:n.length,durationApprox:A})}).catch(function(u){a=!0,g("sprites VTT load failed (std-embed)",u)})}function pt(u){if(!C||!n.length)return;let l=e.getBoundingClientRect(),f=H().getBoundingClientRect(),L=Math.max(36,Math.min(140,Math.round(l.height*.12))),S=u.clientX,F=Math.max(l.left,Math.min(S,l.right)),T=l.width>0?(F-l.left)/l.width:0;T=Math.max(0,Math.min(1,T));let I=(isFinite(e.duration)&&e.duration>0?e.duration:A)*T,h=null;for(let K=0;K<n.length;K++){let V=n[K];if(I>=V.start&&I<V.end){h=V;break}}let y=ft();if(!h||!h.spriteUrl){y.style.display="none";return}let E=h.w>0?h.w:lt,P=h.h>0?h.h:ut;for(;y.firstChild;)y.removeChild(y.firstChild);let b=document.createElement("img");b.src=h.spriteUrl,b.style.position="absolute",b.style.left=-h.x+"px",b.style.top=-h.y+"px",b.style.pointerEvents="none",y.appendChild(b),y.style.display="block",y.style.width=E+"px",y.style.height=P+"px";let R=!!document.fullscreenElement,x=R?clamp(F-E/2,f.left,f.right-E):clamp(F-f.left-E/2,l.left-f.left,l.right-f.left-E),O=l.bottom-(R?0:f.top)-P-L;R||(O=Math.max(0,O)),y.style.left=x+"px",y.style.top=O+"px"}C&&(e.addEventListener("loadedmetadata",function(){Y()}),setTimeout(function(){!i&&!a&&Y()},2500),e.addEventListener("mousemove",function(u){i&&pt(u)}),e.addEventListener("mouseleave",function(){o&&(o.style.display="none")}))}(),q()}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",D):D();})();
