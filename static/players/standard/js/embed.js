(()=>{function V(n,o,d){let i=n.getAttribute(o);if(!i)return d;try{return JSON.parse(i)}catch(m){return d}}var Y="/static/img/fallback_video_notfound.gif";function Q(n,o,d){let i=!1,m=null;function e(A){if(!i){i=!0,d&&d("fallback: applying",A);try{o?o.setAttribute("src",Y):n.src=Y,n.load()}catch(I){}}}function S(){m&&(clearTimeout(m),m=null)}n.addEventListener("loadstart",function(){S(),m=setTimeout(function(){!i&&n.readyState<1&&e("watchdog-timeout")},4e3)}),["loadeddata","canplay","canplaythrough","play","playing"].forEach(function(A){n.addEventListener(A,S)}),n.addEventListener("error",function(){i||e("error-event")}),setTimeout(function(){let A=o?o.getAttribute("src")||"":n.currentSrc||n.src||"";!i&&!A&&e("empty-src")},0)}var ut={};function ct(){try{let o=new URL(ut.url).pathname.match(/\/static\/players\/([^\/]+)\//);if(o&&o[1])return o[1]}catch(n){}try{let o=(document.currentScript&&document.currentScript.src||"").match(/\/static\/players\/([^\/]+)\//);if(o&&o[1])return o[1]}catch(n){}try{let n=document.querySelector(".player-host[data-player]");if(n){let o=String(n.getAttribute("data-player")||"").trim();if(o)return o}}catch(n){}return"standard"}function Z(n,o){let d=null;try{d=n.play()}catch(i){o&&o("play threw",i),d=null}d&&typeof d.then=="function"?d.then(function(){o&&o("play resolved")}).catch(function(i){if(o&&o("play rejected",{name:i&&i.name,msg:i&&i.message}),!n.muted){n.muted=!0,n.setAttribute("muted","");try{n.play()}catch(m){}}}):setTimeout(function(){if(n.paused){n.muted=!0,n.setAttribute("muted","");try{n.play()}catch(i){}}},0)}function $(){let n=ct(),o="/static/players/"+n,d=document.querySelectorAll('.player-host[data-player="'+n+'"]');d.length!==0&&fetch(o+"/templates/player.html",{credentials:"same-origin"}).then(i=>i.text()).then(function(i){for(let m=0;m<d.length;m++)lt(d[m],i,o)}).catch(function(){})}function lt(n,o,d){n.innerHTML=o;let i=n.querySelector(".yrp-container"),m=i.querySelector(".yrp-video-wrap"),e=i.querySelector(".yrp-video"),S=e.querySelector("source"),A=i.querySelector(".yrp-center-play"),I=i.querySelector(".yrp-center-logo"),D=n.getAttribute("data-video-src")||"",W=n.getAttribute("data-poster-url")||"",X=V(n,"data-subtitles",[]),f=V(n,"data-options",{}),k=n.getAttribute("data-sprites-vtt")||"",j=n.getAttribute("data-caption-vtt")||"",N=n.getAttribute("data-caption-lang")||"",tt=/\byrpdebug=1\b/i.test(location.search)||!!(f&&f.debug);function g(){if(tt)try{}catch(t){}}if(I&&I.setAttribute("src",d+"/img/logo.png"),S&&S.setAttribute("src",D),W&&e.setAttribute("poster",W),f&&f.muted&&e.setAttribute("muted",""),f&&f.loop&&e.setAttribute("loop",""),e.setAttribute("playsinline",""),e.setAttribute("controls",""),Array.isArray(X)&&X.forEach(function(t){if(!t||!t.src)return;let a=document.createElement("track");a.setAttribute("kind","subtitles"),t.srclang&&a.setAttribute("srclang",String(t.srclang)),t.label&&a.setAttribute("label",String(t.label)),a.setAttribute("src",String(t.src)),t.default&&a.setAttribute("default",""),e.appendChild(a)}),j)try{let t=document.createElement("track");t.setAttribute("kind","subtitles"),t.setAttribute("src",j),t.setAttribute("srclang",N||"auto"),t.setAttribute("label",N||"Original"),t.setAttribute("default",""),e.appendChild(t)}catch(t){g("caption track append failed",t)}function G(){try{let t=e.textTracks;if(!t||t.length===0)return;let a=!!(f&&f.subtitles===!0),c=!1;for(let u=0;u<t.length;u++){let r=t[u];if(r.kind==="subtitles"||r.kind==="captions"){let E=a||r.language===(N||r.srclang);!c&&E?(r.mode="showing",c=!0):r.mode="hidden"}}if(!c)for(let u=0;u<t.length;u++){let r=t[u];if(r.kind==="subtitles"||r.kind==="captions"){r.mode="showing";break}}}catch(t){}}try{e.load(),g("video.load() called",{src:D})}catch(t){g("video.load() error",t)}Q(e,S,g);function q(){e.paused?i.classList.remove("playing"):i.classList.add("playing")}["loadedmetadata","loadeddata","canplay","canplaythrough","play","pause","stalled","suspend","waiting","error","abort","emptied"].forEach(function(t){e.addEventListener(t,function(){g("event",t,{rs:e.readyState,paused:e.paused,muted:e.muted})})}),e.addEventListener("play",q),e.addEventListener("pause",q),e.addEventListener("loadedmetadata",function(){G();try{let t=e.textTracks;for(let a=0;a<t.length;a++){let c=t[a];c.addEventListener&&c.addEventListener("load",G)}}catch(t){}});function C(){try{let t=window.innerHeight||document.documentElement.clientHeight||i.clientHeight||0;if(t<=0)return;m.style.height=t+"px",e.style.height="100%",e.style.width="100%",e.style.objectFit="contain"}catch(t){}}window.addEventListener("resize",C),window.addEventListener("orientationchange",C),C(),setTimeout(C,0),setTimeout(C,100);let B=!1;function et(){B||(B=!0,setTimeout(function(){B=!1},180),e.paused?Z(e,g):e.pause())}A&&A.addEventListener("click",function(){et()});function nt(t){let a=t.target,c=a&&a.tagName?a.tagName.toUpperCase():"";if(a&&(a.isContentEditable||c==="INPUT"||c==="TEXTAREA")||t.ctrlKey||t.metaKey||t.altKey)return;let u=(t.key||"").toLowerCase(),r=t.code||"";if(u==="j"||r==="ArrowLeft")t.preventDefault(),e.currentTime=Math.max(0,(e.currentTime||0)-5);else if(u==="l"||r==="ArrowRight"){t.preventDefault();let E=isFinite(e.duration)?e.duration:1e9;e.currentTime=Math.min((e.currentTime||0)+5,E)}else u==="m"?(t.preventDefault(),e.muted=!e.muted):u==="f"&&(t.preventDefault(),document.fullscreenElement?document.exitFullscreen().catch(function(){}):i.requestFullscreen&&i.requestFullscreen().catch(function(){}))}document.addEventListener("keydown",nt),function(){let t=!!(f&&f.autoplay===!0);if(g("autoplay check (embed)",{WANT:t,opt:f}),!t)return;function a(u){g("autoplay attempt",u),Z(e,g)}e.readyState>=1&&a("readyState>=1");let c=function(){e.removeEventListener("canplay",c),a("canplay")};e.addEventListener("canplay",c),setTimeout(function(){e.paused&&a("watchdog")},1200)}(),function(){let t=0;if(f&&typeof f.start=="number"&&f.start>0&&(t=Math.max(0,f.start)),!t)return;let a=function(){try{e.currentTime=Math.min(t,Math.floor(e.duration||t))}catch(c){}};isFinite(e.duration)&&e.duration>0?a():e.addEventListener("loadedmetadata",function c(){e.removeEventListener("loadedmetadata",c),a()})}(),function(){let a=[],c=!1,u=!1,r=null,E=0,rt=160,it=90;function J(l){let s=String(l||"").match(/^(\d{2}):(\d{2}):(\d{2}\.\d{3})$/);if(!s)return 0;let p=parseInt(s[1],10),w=parseInt(s[2],10),T=parseFloat(s[3]);return p*3600+w*60+T}function at(l,s){if(!s)return"";if(/^https?:\/\//i.test(s)||s.startsWith("/"))return s;try{return new URL(l,window.location.origin).pathname.replace(/\/sprites\.vtt$/,"")+"/"+s.replace(/^\/+/,"")}catch(p){return s}}function H(){return document.fullscreenElement||m||i}function ot(){if(r)return r;r=document.createElement("div"),r.className="std-embed-sprite-pop",r.style.pointerEvents="none",r.style.display="none",r.style.border="1px solid #333",r.style.background="#000",r.style.overflow="hidden",r.style.boxShadow="0 4px 12px rgba(0,0,0,.4)",r.style.borderRadius="4px",r.style.zIndex="9999";let l=H();return document.fullscreenElement?(r.style.position="fixed",l.appendChild(r)):(r.style.position="absolute",getComputedStyle(l).position==="static"&&(l.style.position="relative"),l.appendChild(r)),r}document.addEventListener("fullscreenchange",function(){if(!r)return;let l=H();try{l.appendChild(r),r.style.position=document.fullscreenElement?"fixed":"absolute"}catch(s){}});function z(){!k||c||u||fetch(k,{credentials:"same-origin"}).then(l=>l.text()).then(function(l){let s=l.split(/\r?\n/);for(let p=0;p<s.length;p++){let w=s[p].trim();if(w&&w.indexOf("-->")>=0){let T=w.split("-->").map(x=>x.trim());if(T.length<2)continue;let M=J(T[0]),v=J(T[1]),U=(s[p+1]||"").trim(),F="",h=0,y=0,L=0,R=0,b=U.indexOf("#xywh=");if(b>0){F=U.substring(0,b);let x=U.substring(b+6).split(",");x.length===4&&(h=parseInt(x[0],10),y=parseInt(x[1],10),L=parseInt(x[2],10),R=parseInt(x[3],10))}let P=at(k,F);a.push({start:M,end:v,spriteUrl:P,x:h,y,w:L,h:R}),v>E&&(E=v),p++}}c=!0,g("sprites VTT loaded (std-embed)",{cues:a.length,durationApprox:E})}).catch(function(l){u=!0,g("sprites VTT load failed (std-embed)",l)})}function st(l){if(!k||!a.length)return;let s=e.getBoundingClientRect(),p=H().getBoundingClientRect(),w=Math.max(36,Math.min(140,Math.round(s.height*.12))),T=l.clientX,M=Math.max(s.left,Math.min(T,s.right)),v=s.width>0?(M-s.left)/s.width:0;v=Math.max(0,Math.min(1,v));let F=(isFinite(e.duration)&&e.duration>0?e.duration:E)*v,h=null;for(let _=0;_<a.length;_++){let K=a[_];if(F>=K.start&&F<K.end){h=K;break}}let y=ot();if(!h||!h.spriteUrl){y.style.display="none";return}let L=h.w>0?h.w:rt,R=h.h>0?h.h:it;for(;y.firstChild;)y.removeChild(y.firstChild);let b=document.createElement("img");b.src=h.spriteUrl,b.style.position="absolute",b.style.left=-h.x+"px",b.style.top=-h.y+"px",b.style.pointerEvents="none",y.appendChild(b),y.style.display="block",y.style.width=L+"px",y.style.height=R+"px";let P=!!document.fullscreenElement,x=P?clamp(M-L/2,p.left,p.right-L):clamp(M-p.left-L/2,s.left-p.left,s.right-p.left-L),O=s.bottom-(P?0:p.top)-R-w;P||(O=Math.max(0,O)),y.style.left=x+"px",y.style.top=O+"px"}k&&(e.addEventListener("loadedmetadata",function(){z()}),setTimeout(function(){!c&&!u&&z()},2500),e.addEventListener("mousemove",function(l){c&&st(l)}),e.addEventListener("mouseleave",function(){r&&(r.style.display="none")}))}(),q()}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",$):$();})();
