<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>YurTube</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link href="/static/css/main.css" rel="stylesheet">
  <link href="/static/css/brand.css" rel="stylesheet">
  <link rel="icon" type="image/png" sizes="32x32" href="{{ favicon_url|default('/static/img/YT_fav32.png') }}">
  <link rel="apple-touch-icon" href="{{ apple_touch_icon_url|default('/static/img/YT_fav128.png') }}">
  <!-- Brython runtime and stdlib -->
  <script src="https://cdn.jsdelivr.net/npm/brython@3.13.0/brython.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/brython@3.13.0/brython_stdlib.js"></script>
  <script type="text/python" src="/static/brython/init.bry"></script>
  <script>
    document.addEventListener("DOMContentLoaded", function(){ brython(); });
  </script>
</head>
<body>
  <header class="site-header">
    <div class="logo">
      <a href="/" aria-label="YurTube home">
        <img class="brand-logo" src="{{ brand_logo_url|default('/static/img/YT_long.png') }}" alt="YurTube">
      </a>
    </div>
    <form class="search-form" action="/search" method="get">
      <input type="text" name="q" placeholder="Search" aria-label="Search">
    </form>
    <nav class="user-nav">
      {% if current_user %}
        <details class="user-menu">
          <summary>
            <img
              id="nav-avatar"
              src="/storage/users/{{ current_user['user_uid'] }}/avatar_small.png"
              alt="me"
              class="avatar"
              data-cache-bust="1"
              onerror="this.onerror=null;this.src='/static/img/avatar_default.svg';"
            >
          </summary>
          <ul>
            <li><a href="/account">Account</a></li>
            <li><a href="/manage">My videos</a></li>
            <li><a href="/subscriptions">My subscriptions</a></li>
            <li><a href="/history">My history</a></li>
            <li class="menu-sep"><hr></li>
            <li><a href="/upload">Upload</a></li>
            <li class="menu-sep"><hr></li>
            <li>
              <form action="/auth/logout" method="post" style="display:inline">
                <button type="submit">Logout</button>
              </form>
            </li>
          </ul>
        </details>
      {% else %}
        <a href="/auth/login">Login</a>
        <a href="/auth/register">Register</a>
      {% endif %}
    </nav>
  </header>

  <div class="layout">
    <aside class="sidebar">
      <ul>
        <li><a href="/">Home</a></li>
        <li><a href="/trending">Trending</a></li>
        <li><a href="/subscriptions">Subscriptions</a></li>
        <li><a href="/history">History</a></li>
      </ul>
    </aside>
    <main class="content">
      {% block content %}{% endblock %}
    </main>
  </div>
</body>
</html>