{% extends "base.html" %}
{% block content %}
<link rel="stylesheet" href="/static/css/manage/account_layout.css">

<div class="manage-comments-layout">
  {% include "account/left.html" %}
  <main class="mc-main">
    <div class="mc-top-bar">
      <h1 class="mc-page-title">Upload video</h1>
      <div class="mc-back-link">
        <a href="/manage">Back to My Videos</a>
      </div>
    </div>

    {% if error %}
    <div class="alert alert-error">{{ error }}</div>
    {% endif %}

    <form id="upload-form" action="/upload" method="post" enctype="multipart/form-data" novalidate>
      <input type="hidden" name="csrf_token" value="{{ csrf_token }}">
      <div>
        <label>File</label>
        <input type="file" name="file" required>
      </div>

      <div>
        <label>Title</label>
        <input type="text" name="title" value="{{ (form.title if form else '') }}">
      </div>
      <div>
        <label>Description</label>
        <textarea name="description">{{ (form.description if form else '') }}</textarea>
      </div>
      <div>
        <label>Status</label>
        <select name="status">
          {% set s = (form.status if form else 'private') %}
          <option value="private" {{ 'selected' if s == 'private' else '' }}>Private</option>
          <option value="unlisted" {{ 'selected' if s == 'unlisted' else '' }}>Unlisted</option>
          <option value="public" {{ 'selected' if s == 'public' else '' }}>Public</option>
        </select>
      </div>
      <div>
        <label>Category</label>
        <select name="category_id">
          {% set csel = (form.category_id if form else '') %}
          <option value="">No category</option>
          {% for c in categories %}
            <option value="{{ c['category_id'] }}" {{ 'selected' if csel == c['category_id'] else '' }}>
              {{ c['name'] }}
            </option>
          {% endfor %}
        </select>
      </div>
      <div>
        <label><input type="checkbox" name="is_age_restricted" {{ 'checked' if form and form.is_age_restricted else '' }}> Age restricted</label>
      </div>
      <div>
        <label><input type="checkbox" name="is_made_for_kids" {{ 'checked' if form and form.is_made_for_kids else '' }}> Made for kids</label>
      </div>

<!-- captions -->
<div>
  <label><input type="checkbox" name="generate_captions" value="1"> Generate captions</label>
</div>
<div>
  <label>Captions language
    <select name="captions_lang">
      <option value="auto" selected>auto</option>
      <option value="en">en</option>
      <option value="ru">ru</option>
      <option value="uk">uk</option>
      <option value="de">de</option>
    </select>
  </label>
</div>
<!-- /captions -->

      <!-- ytconvert options (checkbox UI only for now) -->
      <div id="ytconvert-options" style="display:none; margin-top:10px; padding:8px; border:1px dashed #ddd; border-radius:6px;">
        <div style="font-weight:600; margin-bottom:6px;">Select additional formats (optional)</div>
        <div id="ytconvert-options-body" style="font-size:13px; color:#333;">
            <!-- Removed WEBM as per request -->
        </div>
      </div>
      <!-- /ytconvert options -->

      <button id="upload-submit" type="submit" style="margin-top:10px;" disabled>Upload</button>
      <span id="upload-status" style="margin-left:8px;"></span>
    </form>

    <script src="/static/js/probe.js?v={{ request.app.state.static_version }}"></script>
    <script type="text/python" src="/static/brython/upload.bry"></script>
  </main>
</div>
{% endblock %}