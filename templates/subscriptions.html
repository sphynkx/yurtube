{% extends "base.html" %}
{% block content %}
<link rel="stylesheet" href="/static/css/manage/account_layout.css">

<div class="manage-comments-layout">
  {% include "account/left.html" %}
  <main class="mc-main">
<h1>Subscriptions</h1>
{% if need_login %}
<p>Please <a href="/auth/login">log in</a> to see your subscriptions.</p>
{% else %}
  {% if channels|length == 0 %}
  <p>You are not subscribed to any channels yet.</p>
  {% else %}
  <ul style="list-style:none; padding:0; margin:0;">
    {% for c in channels %}
    <li style="display:flex; align-items:center; justify-content:space-between; padding:8px 0; border-bottom:1px solid #eee;">
      <div style="display:flex; align-items:center; gap:10px;">
        <img class="mini-avatar" src="{{ c['avatar_url_small'] }}" alt="avatar"
             onerror="this.onerror=null;this.src='/static/img/avatar_default.svg';">
        {% if c['username'] %}
          <a href="/@{{ c['username'] }}">@{{ c['username'] }}</a>
        {% else %}
          <a href="/c/{{ c['channel_id'] }}">{{ c['channel_id'] }}</a>
        {% endif %}
      </div>
      <form action="/channel/unsubscribe?csrf_token={{ request.cookies.get('yt_csrf') or '' }}" method="post" style="margin:0;">
        <input type="hidden" name="csrf_token" value="{{ request.cookies.get('yt_csrf') or '' }}">
        <input type="hidden" name="channel_uid" value="{{ c['user_uid'] }}">
        <button type="submit">Unsubscribe</button>
      </form>
    </li>
    {% endfor %}
  </ul>
  {% endif %}
{% endif %}
  </main>
</div>
{% endblock %}