{% extends "base.html" %}
{% block content %}
<h1>Latest videos</h1>
<div class="video-grid">
  {% for v in videos %}
  <div class="video-card">
    <a class="thumb-link" href="/watch?v={{ v['video_id'] }}">
      <img class="thumb-img thumb-still" src="{{ v['thumb_url'] }}" alt="{{ v['title'] }}">
      {% if v['thumb_anim_url'] %}
      <img class="thumb-img thumb-anim" src="{{ v['thumb_anim_url'] }}" alt="{{ v['title'] }}">
      {% endif %}
    </a>
    <div class="meta">
      <div class="title"><a href="/watch?v={{ v['video_id'] }}">{{ v['title'] }}</a></div>
      <div class="author author-line">
        <img class="mini-avatar"
             src="{{ v.get('author_avatar_url_small', '/static/img/avatar_default.svg') }}"
             alt="avatar"
             onerror="this.onerror=null;this.src='/static/img/avatar_default.svg';">
        {% if v.get('username') %}
          <span><a href="/@{{ v['username'] }}">@{{ v['username'] }}</a></span>
        {% else %}
          <span><a href="/c/{{ v['channel_id'] }}">{{ v['channel_id'] }}</a></span>
        {% endif %}
      </div>
    </div>
  </div>
  {% endfor %}
</div>

<nav class="pagination" style="display:flex; align-items:center; gap:8px; justify-content:center; margin:24px 0;">
  {% if has_prev %}
    <a class="btn" href="/?page={{ prev_page }}&page_size={{ page_size }}"
       style="padding:6px 12px; border:1px solid #ddd; border-radius:6px; text-decoration:none; color:#111;">« Previous</a>
  {% else %}
    <span class="btn disabled" style="padding:6px 12px; border:1px solid #eee; border-radius:6px; color:#aaa;">« Previous</span>
  {% endif %}

  <span style="display:flex; gap:8px; align-items:center;">
    {% for item in page_items %}
      {% if item.kind == 'ellipsis' %}
        <span style="opacity:0.7; padding:6px 12px; border:1px solid #eee; border-radius:6px;">…</span>
      {% elif item.kind == 'number' %}
        {% if item.current %}
          <span style="padding:6px 12px; border:1px solid #111; border-radius:6px; background:#111; color:#fff;">{{ item.num }}</span>
        {% else %}
          <a href="{{ item.url }}"
             style="padding:6px 12px; border:1px solid #ddd; border-radius:6px; text-decoration:none; color:#111;">{{ item.num }}</a>
        {% endif %}
      {% endif %}
    {% endfor %}
  </span>

  {% if has_next %}
    <a class="btn" href="/?page={{ next_page }}&page_size={{ page_size }}"
       style="padding:6px 12px; border:1px solid #ddd; border-radius:6px; text-decoration:none; color:#111;">Next »</a>
  {% else %}
    <span class="btn disabled" style="padding:6px 12px; border:1px solid #eee; border-radius:6px; color:#aaa;">Next »</span>
  {% endif %}
</nav>

<div style="clear:both;"></div>
{% include "partials/footer.html" %}
{% endblock %}